## åŸºæœ¬æ¦‚å¿µ

### çŠ¶æ€å˜é‡

çŠ¶æ€å˜é‡æ˜¯è¢«**æ°¸ä¹…åœ°**ä¿å­˜åœ¨åˆçº¦ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬è¢«å†™å…¥ä»¥å¤ªå¸åŒºå—é“¾ä¸­ï¼ˆæƒ³è±¡æˆå†™å…¥ä¸€ä¸ªæ•°æ®åº“ï¼‰ã€‚

```solidity
contract Example {
  // è¿™ä¸ªæ— ç¬¦å·æ•´æ•°å°†ä¼šæ°¸ä¹…çš„è¢«ä¿å­˜åœ¨åŒºå—é“¾ä¸­
  uint myUnsignedInteger = 100;
}
```

### å…¨å±€å˜é‡

å…¨å±€å˜é‡æ˜¯å…¨å±€èŒƒå›´å·¥ä½œçš„å˜é‡ï¼Œéƒ½æ˜¯`solidity`é¢„ç•™å…³é”®å­—ã€‚ä»–ä»¬å¯ä»¥åœ¨å‡½æ•°å†…ä¸å£°æ˜ç›´æ¥ä½¿ç”¨ï¼š

ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å…¨å±€å˜é‡ï¼Œæ›´å®Œæ•´çš„åˆ—è¡¨è¯·çœ‹è¿™ä¸ª[é“¾æ¥](https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions)ï¼š

-   `blockhash(uint blockNumber)`
	- (`bytes32`)ç»™å®šåŒºå—çš„å“ˆå¸Œå€¼ â€“ åªé€‚ç”¨äº256æœ€è¿‘åŒºå—, ä¸åŒ…å«å½“å‰åŒºå—ã€‚
-   `block.coinbase`: (`address payable`)
	- å½“å‰åŒºå—çŸ¿å·¥çš„åœ°å€
-   `block.gaslimit`: (`uint`)
	- å½“å‰åŒºå—çš„gaslimit
-   `block.number`: (`uint`)
	- å½“å‰åŒºå—çš„number
-   `block.timestamp`: (`uint`)
	- å½“å‰åŒºå—çš„æ—¶é—´æˆ³ï¼Œä¸ºunixçºªå…ƒä»¥æ¥çš„ç§’
-   `gasleft()`: (`uint256`)
	- å‰©ä½™ gas
-   `msg.data`: (`bytes calldata`)
	- å®Œæ•´call data
-   `msg.sender`: (`address payable`)
	- æ¶ˆæ¯å‘é€è€… (å½“å‰ caller)
-   `msg.sig`: (`bytes4`)
	- calldataçš„å‰å››ä¸ªå­—èŠ‚ (function identifier)
-   `msg.value`: (`uint`)
	- å½“å‰äº¤æ˜“å‘é€çš„`wei`å€¼

#### msg.sender

`msg.sender` æŒ‡çš„æ˜¯å½“å‰è°ƒç”¨è€…ï¼ˆæˆ–æ™ºèƒ½åˆçº¦ï¼‰çš„Â `address`ã€‚

> æ³¨æ„ï¼šåœ¨ Solidity ä¸­ï¼ŒåŠŸèƒ½æ‰§è¡Œå§‹ç»ˆéœ€è¦ä»å¤–éƒ¨è°ƒç”¨è€…å¼€å§‹ã€‚ ä¸€ä¸ªåˆçº¦åªä¼šåœ¨åŒºå—é“¾ä¸Šä»€ä¹ˆä¹Ÿä¸åšï¼Œé™¤éæœ‰äººè°ƒç”¨å…¶ä¸­çš„å‡½æ•°ã€‚æ‰€ä»¥Â `msg.sender`æ€»æ˜¯å­˜åœ¨çš„ã€‚

ä»¥ä¸‹æ˜¯ä½¿ç”¨Â `msg.sender`Â æ¥æ›´æ–°Â `mapping`Â çš„ä¾‹å­ï¼š

```sol
mapping (address => uint) favoriteNumber;

function setMyNumber(uint _myNumber) public {
  // æ›´æ–°æˆ‘ä»¬çš„ `favoriteNumber` æ˜ å°„æ¥å°† `_myNumber`å­˜å‚¨åœ¨ `msg.sender`åä¸‹
  favoriteNumber[msg.sender] = _myNumber;
  // å­˜å‚¨æ•°æ®è‡³æ˜ å°„çš„æ–¹æ³•å’Œå°†æ•°æ®å­˜å‚¨åœ¨æ•°ç»„ç›¸ä¼¼
}

function whatIsMyNumber() public view returns (uint) {
  // æ‹¿åˆ°å­˜å‚¨åœ¨è°ƒç”¨è€…åœ°å€åä¸‹çš„å€¼
  // è‹¥è°ƒç”¨è€…è¿˜æ²¡è°ƒç”¨ setMyNumberï¼Œ åˆ™å€¼ä¸º `0`
  return favoriteNumber[msg.sender];
}
```

åœ¨è¿™ä¸ªå°å°çš„ä¾‹å­ä¸­ï¼Œä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨Â `setMyNumber`Â åœ¨æˆ‘ä»¬çš„åˆçº¦ä¸­å­˜ä¸‹ä¸€ä¸ªÂ `uint`Â å¹¶ä¸”ä¸ä»–ä»¬çš„åœ°å€ç›¸ç»‘å®šã€‚ ç„¶åï¼Œä»–ä»¬è°ƒç”¨Â `whatIsMyNumber`Â å°±ä¼šè¿”å›ä»–ä»¬å­˜å‚¨çš„Â `uint`ã€‚

ä½¿ç”¨Â `msg.sender`Â å¾ˆå®‰å…¨ï¼Œå› ä¸ºå®ƒå…·æœ‰ä»¥å¤ªåŠåŒºå—é“¾çš„å®‰å…¨ä¿éšœ â€”â€” é™¤éçªƒå–ä¸ä»¥å¤ªåŠåœ°å€ç›¸å…³è”çš„ç§é’¥ï¼Œå¦åˆ™æ˜¯æ²¡æœ‰åŠæ³•ä¿®æ”¹å…¶ä»–äººçš„æ•°æ®çš„ã€‚


### æ•°æ®ç±»å‹

#### æ— ç¬¦å·æ•´æ•°:Â `uint`

`uint`Â æ— ç¬¦å·æ•°æ®ç±»å‹ï¼Œ æŒ‡**å…¶å€¼ä¸èƒ½æ˜¯è´Ÿæ•°**ï¼Œå¯¹äºæœ‰ç¬¦å·çš„æ•´æ•°å­˜åœ¨åä¸ºÂ `int`Â çš„æ•°æ®ç±»å‹ã€‚

> æ³¨: Solidityä¸­ï¼ŒÂ `uint`Â å®é™…ä¸Šæ˜¯Â `uint256`ä»£åè¯ï¼Œ ä¸€ä¸ª256ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä½æ•°å°‘çš„uints â€”Â `uint8`ï¼ŒÂ `uint16`ï¼ŒÂ `uint32`ï¼Œ ç­‰â€¦â€¦ ä½†ä¸€èˆ¬æ¥è®²ä½ æ„¿æ„ä½¿ç”¨ç®€å•çš„Â `uint`ï¼Œ é™¤éåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¿™æˆ‘ä»¬åé¢ä¼šè®²ã€‚

#### å­—ç¬¦ä¸²:Â `string`

å­—ç¬¦ä¸²ç”¨äºä¿å­˜ä»»æ„é•¿åº¦çš„ UTF-8 ç¼–ç æ•°æ®ã€‚ å¦‚ï¼šÂ `string greeting = "Hello world!"`ã€‚

> æ³¨: Solidityä¸­ï¼ŒÂ `uint`Â å®é™…ä¸Šæ˜¯Â `uint256`ä»£åè¯ï¼Œ ä¸€ä¸ª256ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä½æ•°å°‘çš„uints â€”Â `uint8`ï¼ŒÂ `uint16`ï¼ŒÂ `uint32`ï¼Œ ç­‰â€¦â€¦ ä½†ä¸€èˆ¬æ¥è®²ä½ æ„¿æ„ä½¿ç”¨ç®€å•çš„Â `uint`ï¼Œ é™¤éåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¿™æˆ‘ä»¬åé¢ä¼šè®²ã€‚


### æ•°å­¦è¿ç®—

åœ¨ Solidity ä¸­ï¼Œæ•°å­¦è¿ç®—å¾ˆç›´è§‚æ˜äº†ï¼Œä¸å…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ç›¸åŒ:

-   åŠ æ³•:Â `x + y`
-   å‡æ³•:Â `x - y`,
-   ä¹˜æ³•:Â `x * y`
-   é™¤æ³•:Â `x / y`
-   å–æ¨¡ / æ±‚ä½™:Â `x % y`Â _(ä¾‹å¦‚,Â `13 % 5`Â ä½™Â `3`, å› ä¸º13é™¤ä»¥5ï¼Œä½™3)_

Solidity è¿˜æ”¯æŒÂ **_ä¹˜æ–¹æ“ä½œ_**Â (å¦‚ï¼šx çš„ yæ¬¡æ–¹ï¼‰ // ä¾‹å¦‚ï¼š 5 ** 2 = 25

```
uint x = 5 ** 2; // equal to 5^2 = 25
```


### æ•°ç»„

Solidity æ”¯æŒä¸¤ç§æ•°ç»„:Â **é™æ€**æ•°ç»„ å’Œ **åŠ¨æ€**æ•°ç»„

```
// å›ºå®šé•¿åº¦ä¸º2çš„é™æ€æ•°ç»„:
uint[2] fixedArray;
// å›ºå®šé•¿åº¦ä¸º5çš„stringç±»å‹çš„é™æ€æ•°ç»„:
string[5] stringArray;
// åŠ¨æ€æ•°ç»„ï¼Œé•¿åº¦ä¸å›ºå®šï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ å…ƒç´ :
uint[] dynamicArray;
```

ä½ ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ªÂ **ç»“æ„ä½“ç±»å‹**çš„æ•°ç»„

```
Person[] people; // è¿™æ˜¯åŠ¨æ€æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­æ·»åŠ å…ƒç´ 
```

> è®°ä½ï¼šçŠ¶æ€å˜é‡è¢«==æ°¸ä¹…ä¿å­˜==åœ¨åŒºå—é“¾ä¸­ã€‚æ‰€ä»¥åœ¨ä½ çš„åˆçº¦ä¸­åˆ›å»ºåŠ¨æ€æ•°ç»„æ¥ä¿å­˜æˆç»“æ„çš„æ•°æ®æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚

#### å…¬å…±æ•°ç»„

ä½ å¯ä»¥å®šä¹‰Â `public`Â æ•°ç»„, Solidity ä¼šè‡ªåŠ¨åˆ›å»ºÂ **_getter_**Â æ–¹æ³•. è¯­æ³•å¦‚ä¸‹:

```
Person[] public people;
```

å…¶å®ƒçš„åˆçº¦**å¯ä»¥**ä»è¿™ä¸ªæ•°ç»„**è¯»å–**æ•°æ®ï¼ˆä½†*ä¸èƒ½å†™å…¥*æ•°æ®ï¼‰ï¼Œæ‰€ä»¥è¿™åœ¨åˆçº¦ä¸­æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿å­˜å…¬å…±æ•°æ®çš„æ¨¡å¼ã€‚

### ç»“æ„ä½“

æœ‰æ—¶ä½ éœ€è¦æ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼ŒSolidity æä¾›äº†Â **ç»“æ„ä½“**:

```
struct Person {
  uint age;
  string name;
}
```

ç»“æ„ä½“å…è®¸ä½ ç”Ÿæˆä¸€ä¸ªæ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œå®ƒæœ‰*å¤šä¸ªå±æ€§*ã€‚

### ä½¿ç”¨ç»“æ„ä½“å’Œæ•°ç»„

```
struct Person {
  uint age;
  string name;
}

Person[] public people;
```

ç°åœ¨æˆ‘ä»¬åˆ›å»ºæ–°çš„Â `Person`Â ç»“æ„ï¼Œç„¶åæŠŠå®ƒåŠ å…¥åˆ°åä¸ºÂ `people`Â çš„æ•°ç»„ä¸­

```
// åˆ›å»ºä¸€ä¸ªæ–°çš„Person:
Person satoshi = Person(172, "Satoshi");

// å°†æ–°åˆ›å»ºçš„satoshiæ·»åŠ è¿›peopleæ•°ç»„:
people.push(satoshi);
```

ä½ ä¹Ÿå¯ä»¥ä¸¤æ­¥å¹¶ä¸€æ­¥ï¼Œç”¨ä¸€è¡Œä»£ç æ›´ç®€æ´:

```
people.push(Person(16, "Vitalik"));
```

> æ³¨ï¼š`array.push()`Â åœ¨æ•°ç»„çš„Â **å°¾éƒ¨**Â åŠ å…¥æ–°å…ƒç´  ï¼Œæ‰€ä»¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„é¡ºåºå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„é¡ºåºï¼ˆå’Œ JS é‡Œä¸€æ ·ï¼‰

```
uint[] numbers;
numbers.push(5);
numbers.push(10);
numbers.push(15);
// numbers is now equal to [5, 10, 15]
```


### Addresses ï¼ˆåœ°å€ï¼‰

ä»¥å¤ªåŠåŒºå—é“¾ç”±Â **account**Â (è´¦æˆ·)ç»„æˆï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆé“¶è¡Œè´¦æˆ·ã€‚ä¸€ä¸ªå¸æˆ·çš„ä½™é¢æ˜¯Â **_ä»¥å¤ª_**Â ï¼ˆåœ¨ä»¥å¤ªåŠåŒºå—é“¾ä¸Šä½¿ç”¨çš„å¸ç§ï¼‰ã€‚
ä½ å¯ä»¥å’Œå…¶ä»–å¸æˆ·ä¹‹é—´æ”¯ä»˜å’Œæ¥å—ä»¥å¤ªå¸ï¼Œå°±åƒä½ çš„é“¶è¡Œå¸æˆ·å¯ä»¥ç”µæ±‡èµ„é‡‘åˆ°å…¶ä»–é“¶è¡Œå¸æˆ·ä¸€æ ·ã€‚

æ¯ä¸ªå¸æˆ·éƒ½æœ‰ä¸€ä¸ªâ€œåœ°å€â€ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆé“¶è¡Œè´¦å·ã€‚è¿™æ˜¯è´¦æˆ·å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå®ƒçœ‹èµ·æ¥é•¿è¿™æ ·ï¼š

`0x0cE446255506E92DF41614C46F1d6df9Cc969183`

ï¼ˆè¿™æ˜¯ CryptoZombies å›¢é˜Ÿçš„åœ°å€ï¼Œå¦‚æœä½ å–œæ¬¢ CryptoZombies çš„è¯ï¼Œè¯·æ‰“èµæˆ‘ä»¬ä¸€äº›ä»¥å¤ªå¸ï¼ğŸ˜‰ï¼‰

æˆ‘ä»¬å°†åœ¨åé¢çš„è¯¾ç¨‹ä¸­ä»‹ç»åœ°å€çš„ç»†èŠ‚ï¼Œç°åœ¨ä½ åªéœ€è¦äº†è§£**åœ°å€å±äºç‰¹å®šç”¨æˆ·ï¼ˆæˆ–æ™ºèƒ½åˆçº¦ï¼‰çš„**ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‡å®šâ€œåœ°å€â€ä½œä¸ºåƒµå°¸ä¸»äººçš„ IDã€‚å½“ç”¨æˆ·é€šè¿‡ä¸æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº¤äº’æ¥åˆ›å»ºæ–°çš„åƒµå°¸æ—¶ï¼Œæ–°åƒµå°¸çš„æ‰€æœ‰æƒè¢«è®¾ç½®åˆ°è°ƒç”¨è€…çš„ä»¥å¤ªåŠåœ°å€ä¸‹ã€‚

### Mappingï¼ˆæ˜ å°„ï¼‰

åœ¨å‰é¢æˆ‘ä»¬çœ‹åˆ°äº†Â *ç»“æ„ä½“Â å’ŒÂ *æ•°ç»„*Â ã€‚Â **æ˜ å°„**Â æ˜¯å¦ä¸€ç§åœ¨ Solidity ä¸­å­˜å‚¨æœ‰ç»„ç»‡æ•°æ®çš„æ–¹æ³•ã€‚

æ˜ å°„æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š

```
//å¯¹äºé‡‘èåº”ç”¨ç¨‹åºï¼Œå°†ç”¨æˆ·çš„ä½™é¢ä¿å­˜åœ¨ä¸€ä¸ª uintç±»å‹çš„å˜é‡ä¸­ï¼š
mapping (address => uint) public accountBalance;
//æˆ–è€…å¯ä»¥ç”¨æ¥é€šè¿‡userId å­˜å‚¨/æŸ¥æ‰¾çš„ç”¨æˆ·å
mapping (uint => string) userIdToName;
```

æ˜ å°„æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨å’ŒæŸ¥æ‰¾æ•°æ®æ‰€ç”¨çš„é”®-å€¼å¯¹ã€‚åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œé”®æ˜¯ä¸€ä¸ªÂ `address`ï¼Œå€¼æ˜¯ä¸€ä¸ªÂ `uint`ï¼Œåœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œé”®æ˜¯ä¸€ä¸ª`uint`ï¼Œå€¼æ˜¯ä¸€ä¸ªÂ `string`ã€‚



## å‡½æ•°

### å®šä¹‰å‡½æ•°

åœ¨ Solidity ä¸­å‡½æ•°å®šä¹‰çš„å¥æ³•å¦‚ä¸‹:

```
function eatHamburgers(string _name, uint _amount) {
    // ...
}
```

è¿™æ˜¯ä¸€ä¸ªåä¸ºÂ `eatHamburgers`Â çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªÂ `string`ç±»å‹çš„ å’Œ ä¸€ä¸ªÂ `uint`ç±»å‹çš„ã€‚ç°åœ¨å‡½æ•°å†…éƒ¨è¿˜æ˜¯ç©ºçš„ã€‚

> æ³¨ï¼š: ä¹ æƒ¯ä¸Šå‡½æ•°é‡Œçš„**å˜é‡éƒ½æ˜¯ä»¥( `_` )å¼€å¤´** (ä½†ä¸æ˜¯ç¡¬æ€§è§„å®š) ä»¥åŒºåˆ«å…¨å±€å˜é‡ã€‚

### ç§æœ‰ / å…¬å…±å‡½æ•°

Solidity å®šä¹‰çš„å‡½æ•°çš„å±æ€§é»˜è®¤ä¸º`å…¬å…±`ã€‚ è¿™å°±æ„å‘³ç€ä»»ä½•ä¸€æ–¹ (æˆ–å…¶å®ƒåˆçº¦) éƒ½å¯ä»¥è°ƒç”¨ä½ åˆçº¦é‡Œçš„å‡½æ•°ã€‚

æ˜¾ç„¶ï¼Œä¸æ˜¯ä»€ä¹ˆæ—¶å€™éƒ½éœ€è¦è¿™æ ·ï¼Œè€Œä¸”è¿™æ ·çš„åˆçº¦æ˜“äºå—åˆ°æ”»å‡»ã€‚ æ‰€ä»¥å°†è‡ªå·±çš„å‡½æ•°å®šä¹‰ä¸º`ç§æœ‰`æ˜¯ä¸€ä¸ªå¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œåªæœ‰å½“ä½ éœ€è¦å¤–éƒ¨ä¸–ç•Œè°ƒç”¨å®ƒæ—¶æ‰å°†å®ƒè®¾ç½®ä¸º`å…¬å…±`ã€‚

å¦‚ä½•å®šä¹‰ä¸€ä¸ªç§æœ‰çš„å‡½æ•°å‘¢ï¼Ÿ

```
uint[] numbers;

function _addToArray(uint _number) private {
  numbers.push(_number);
}
```

è¿™æ„å‘³ç€åªæœ‰æˆ‘ä»¬åˆçº¦ä¸­çš„å…¶å®ƒå‡½æ•°æ‰èƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œç»™Â `numbers`Â æ•°ç»„æ·»åŠ æ–°æˆå‘˜ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°åå­—åé¢ä½¿ç”¨å…³é”®å­—Â `private`Â å³å¯ã€‚å’Œå‡½æ•°çš„å‚æ•°ç±»ä¼¼ï¼Œç§æœ‰å‡½æ•°çš„åå­—ç”¨( `_` )èµ·å§‹ã€‚


### å‡½æ•°è¿”å›å€¼

è¦æƒ³å‡½æ•°è¿”å›ä¸€ä¸ªæ•°å€¼ï¼ŒæŒ‰å¦‚ä¸‹å®šä¹‰ï¼š

```
string greeting = "What's up dog";

function sayHello() public returns (string) {
  return greeting;
}
```

Solidity é‡Œï¼Œå‡½æ•°çš„å®šä¹‰é‡Œå¯åŒ…å«è¿”å›å€¼çš„æ•°æ®ç±»å‹(å¦‚æœ¬ä¾‹ä¸­Â `string`)ã€‚

### å‡½æ•°ä¿®é¥°ç¬¦

#### view å’Œ pure

ä¸Šé¢çš„å‡½æ•°å®é™…ä¸Šæ²¡æœ‰æ”¹å˜ Solidity é‡Œçš„çŠ¶æ€ï¼Œå³ï¼Œå®ƒæ²¡æœ‰æ”¹å˜ä»»ä½•å€¼æˆ–è€…å†™ä»»ä½•ä¸œè¥¿ã€‚

è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥æŠŠå‡½æ•°å®šä¹‰ä¸ºÂ **_view_**, æ„å‘³ç€å®ƒ==åªèƒ½è¯»å–æ•°æ®ä¸èƒ½æ›´æ”¹æ•°æ®==

```
function sayHello() public view returns (string) {
```

Solidity è¿˜æ”¯æŒÂ **_pure_**Â å‡½æ•°, è¡¨æ˜è¿™ä¸ªå‡½æ•°ç”šè‡³éƒ½ä¸è®¿é—®åº”ç”¨é‡Œçš„æ•°æ®ï¼Œä¾‹å¦‚ï¼š

```
function _multiply(uint a, uint b) private pure returns (uint) {
  return a * b;
}
```

è¿™ä¸ªå‡½æ•°ç”šè‡³éƒ½ä¸è¯»å–åº”ç”¨é‡Œçš„çŠ¶æ€ â€” å®ƒçš„è¿”å›å€¼å®Œå…¨å–å†³äºå®ƒçš„è¾“å…¥å‚æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æŠŠå‡½æ•°å®šä¹‰ä¸ºÂ **_pure_**.

> æ³¨ï¼šå¯èƒ½å¾ˆéš¾è®°ä½ä½•æ—¶æŠŠå‡½æ•°æ ‡è®°ä¸º pure/viewã€‚ å¹¸è¿çš„æ˜¯ï¼Œ Solidity ç¼–è¾‘å™¨ä¼šç»™å‡ºæç¤ºï¼Œæé†’ä½ ä½¿ç”¨è¿™äº›ä¿®é¥°ç¬¦ã€‚


#### internal å’Œ external

é™¤Â `public`Â å’ŒÂ `private`Â å±æ€§ä¹‹å¤–ï¼ŒSolidity è¿˜ä½¿ç”¨äº†å¦å¤–ä¸¤ä¸ªæè¿°å‡½æ•°å¯è§æ€§çš„ä¿®é¥°è¯ï¼š`internal`ï¼ˆå†…éƒ¨ï¼‰ å’ŒÂ `external`ï¼ˆå¤–éƒ¨ï¼‰ã€‚

`internal`Â å’ŒÂ `private`Â ç±»ä¼¼ï¼Œä¸è¿‡ï¼Œ å¦‚æœæŸä¸ªåˆçº¦ç»§æ‰¿è‡ªå…¶çˆ¶åˆçº¦ï¼Œè¿™ä¸ªåˆçº¦å³å¯ä»¥è®¿é—®çˆ¶åˆçº¦ä¸­å®šä¹‰çš„â€œå†…éƒ¨â€å‡½æ•°ã€‚ï¼ˆå˜¿ï¼Œè¿™å¬èµ·æ¥æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‚£æ ·ï¼ï¼‰ã€‚

`external`Â ä¸`public`Â ç±»ä¼¼ï¼Œåªä¸è¿‡è¿™äº›å‡½æ•°åªèƒ½åœ¨åˆçº¦ä¹‹å¤–è°ƒç”¨ - å®ƒä»¬ä¸èƒ½è¢«åˆçº¦å†…çš„å…¶ä»–å‡½æ•°è°ƒç”¨ã€‚ç¨åæˆ‘ä»¬å°†è®¨è®ºä»€ä¹ˆæ—¶å€™ä½¿ç”¨Â `external`Â å’ŒÂ `public`ã€‚

å£°æ˜å‡½æ•°Â `internal`Â æˆ–Â `external`Â ç±»å‹çš„è¯­æ³•ï¼Œä¸å£°æ˜Â `private`Â å’ŒÂ `public` ç±»å‹ç›¸åŒï¼š

```
contract Sandwich {
  uint private sandwichesEaten = 0;

  function eat() internal {
    sandwichesEaten++;
  }
}

contract BLT is Sandwich {
  uint private baconSandwichesEaten = 0;

  function eatWithBacon() public returns (string) {
    baconSandwichesEaten++;
    // å› ä¸ºeat() æ˜¯internal çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½åœ¨è¿™é‡Œè°ƒç”¨
    eat();
  }
}
```


### Keccak256 ä¼ªéšæœºæ•°

å¦‚ä½•è®©å‡½æ•°è¿”å›ä¸€ä¸ªå…¨(åŠ) éšæœºçš„Â `uint`?

Ethereum å†…éƒ¨æœ‰ä¸€ä¸ªæ•£åˆ—å‡½æ•°`keccak256`ï¼Œå®ƒç”¨äº†SHA3ç‰ˆæœ¬ã€‚ä¸€ä¸ªæ•£åˆ—å‡½æ•°åŸºæœ¬ä¸Šå°±æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ª256ä½çš„16è¿›åˆ¶æ•°å­—ã€‚å­—ç¬¦ä¸²çš„ä¸€ä¸ªå¾®å°å˜åŒ–ä¼šå¼•èµ·æ•£åˆ—æ•°æ®æå¤§å˜åŒ–ã€‚

è¿™åœ¨ Ethereum ä¸­æœ‰å¾ˆå¤šåº”ç”¨ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åªæ˜¯ç”¨å®ƒé€ ä¸€ä¸ªä¼ªéšæœºæ•°ã€‚

ä¾‹å­:

```
//6e91ec6b618bb462a4a6ee5aa2cb0e9cf30f7a052bb467b0ba58b8748c00d2e5
keccak256("aaaab");
//b1f078126895a1424524de5321b339ab00408010b7cf0e6ed451514981e58aa9
keccak256("aaaac");
```

æ˜¾è€Œæ˜“è§ï¼Œè¾“å…¥å­—ç¬¦ä¸²åªæ”¹å˜äº†ä¸€ä¸ªå­—æ¯ï¼Œè¾“å‡ºå°±å·²ç»å¤©å£¤ä¹‹åˆ«äº†ã€‚

> æ³¨: åœ¨åŒºå—é“¾ä¸­==å®‰å…¨åœ°==äº§ç”Ÿä¸€ä¸ªéšæœºæ•°æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„é—®é¢˜ï¼Œ æœ¬ä¾‹çš„æ–¹æ³•ä¸å®‰å…¨ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„Zombie DNAç®—æ³•é‡Œä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå·²ç»å¾ˆå¥½åœ°æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦äº†ã€‚

## ç±»å‹è½¬æ¢

æœ‰æ—¶ä½ éœ€è¦å˜æ¢æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚:

```
uint8 a = 5;
uint b = 6;
// å°†ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º a * b è¿”å› uint, è€Œä¸æ˜¯ uint8:
uint8 c = a * b;
// æˆ‘ä»¬éœ€è¦å°† b è½¬æ¢ä¸º uint8:
uint8 c = a * uint8(b);
```

ä¸Šé¢,Â `a * b`Â è¿”å›ç±»å‹æ˜¯Â `uint`, ä½†æ˜¯å½“æˆ‘ä»¬å°è¯•ç”¨Â `uint8`Â ç±»å‹æ¥æ”¶æ—¶, å°±ä¼šé€ æˆæ½œåœ¨çš„é”™è¯¯ã€‚å¦‚æœæŠŠå®ƒçš„æ•°æ®ç±»å‹è½¬æ¢ä¸ºÂ `uint8`, å°±å¯ä»¥äº†ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šå‡ºé”™ã€‚


## äº‹ä»¶

æˆ‘ä»¬çš„åˆçº¦å‡ ä¹å°±è¦å®Œæˆäº†ï¼è®©æˆ‘ä»¬åŠ ä¸Šä¸€ä¸ª**äº‹ä»¶**

**äº‹ä»¶**Â æ˜¯åˆçº¦å’ŒåŒºå—é“¾é€šè®¯çš„ä¸€ç§æœºåˆ¶ã€‚ä½ çš„å‰ç«¯åº”ç”¨â€œç›‘å¬â€æŸäº›äº‹ä»¶ï¼Œå¹¶åšå‡ºååº”ã€‚

ä¾‹å­:

```
// è¿™é‡Œå»ºç«‹äº‹ä»¶
event IntegersAdded(uint x, uint y, uint result);

function add(uint _x, uint _y) public {
  uint result = _x + _y;
  //è§¦å‘äº‹ä»¶ï¼Œé€šçŸ¥app
  IntegersAdded(_x, _y, result);
  return result;
}
```

ä½ çš„ app å‰ç«¯å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶ã€‚JavaScript å®ç°å¦‚ä¸‹:

```js
YourContract.IntegersAdded(function(error, result) {
  // ...
})
```


## Web3.js

æˆ‘ä»¬çš„ Solidity åˆçº¦å®Œå·¥äº†ï¼ ç°åœ¨æˆ‘ä»¬è¦å†™ä¸€æ®µ JavaScript å‰ç«¯ä»£ç æ¥è°ƒç”¨è¿™ä¸ªåˆçº¦ã€‚

ä»¥å¤ªåŠæœ‰ä¸€ä¸ª JavaScript åº“ï¼Œåä¸º**Web3.js**ã€‚

åœ¨åé¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥åœ°æ•™ä½ å¦‚ä½•å®‰è£…ä¸€ä¸ªåˆçº¦ï¼Œå¦‚ä½•è®¾ç½® Web3.js ã€‚ ä½†æ˜¯ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥äº†è§£ Web3.js æ˜¯å¦‚ä½•å’Œæˆ‘ä»¬å‘å¸ƒçš„åˆçº¦äº¤äº’çš„å§ã€‚

å¦‚æœä¸‹é¢çš„ä»£ç ä½ ä¸èƒ½å…¨éƒ½ç†è§£ï¼Œä¸ç”¨æ‹…å¿ƒã€‚

```js
// ä¸‹é¢æ˜¯è°ƒç”¨åˆçº¦çš„æ–¹å¼:
var abi = /* abiæ˜¯ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ */
var ZombieFactoryContract = web3.eth.contract(abi)
var contractAddress = /* å‘å¸ƒä¹‹ååœ¨ä»¥å¤ªåŠä¸Šç”Ÿæˆçš„åˆçº¦åœ°å€ */
var ZombieFactory = ZombieFactoryContract.at(contractAddress)
// `ZombieFactory` èƒ½è®¿é—®å…¬å…±çš„å‡½æ•°ä»¥åŠäº‹ä»¶

// æŸä¸ªç›‘å¬æ–‡æœ¬è¾“å…¥çš„ç›‘å¬å™¨:
$("#ourButton").click(function(e) {
  var name = $("#nameInput").val()
  //è°ƒç”¨åˆçº¦çš„ `createRandomZombie` å‡½æ•°:
  ZombieFactory.createRandomZombie(name)
})

// ç›‘å¬ `NewZombie` äº‹ä»¶, å¹¶ä¸”æ›´æ–°UI
var event = ZombieFactory.NewZombie(function(error, result) {
  if (error) return
  generateZombie(result.zombieId, result.name, result.dna)
})

// è·å– Zombie çš„ dna, æ›´æ–°å›¾åƒ
function generateZombie(id, name, dna) {
  let dnaStr = String(dna)
  // å¦‚æœdnaå°‘äº16ä½,åœ¨å®ƒå‰é¢ç”¨0è¡¥ä¸Š
  while (dnaStr.length < 16)
    dnaStr = "0" + dnaStr

  let zombieDetails = {
    // å‰ä¸¤ä½æ•°æ„æˆå¤´éƒ¨.æˆ‘ä»¬å¯èƒ½æœ‰7ç§å¤´éƒ¨, æ‰€ä»¥ % 7
    // å¾—åˆ°çš„æ•°åœ¨0-6,å†åŠ ä¸Š1,æ•°çš„èŒƒå›´å˜æˆ1-7
    // é€šè¿‡è¿™æ ·è®¡ç®—ï¼š
    headChoice: dnaStr.substring(0, 2) % 7 + 1ï¼Œ
    // æˆ‘ä»¬å¾—åˆ°çš„å›¾ç‰‡åç§°ä»head1.png åˆ° head7.png

    // æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆçœ¼ç›, çœ¼ç›å˜åŒ–å°±å¯¹11å–æ¨¡:
    eyeChoice: dnaStr.substring(2, 4) % 11 + 1,
    // å†æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆè¡£æœï¼Œè¡£æœå˜åŒ–å°±å¯¹6å–æ¨¡:
    shirtChoice: dnaStr.substring(4, 6) % 6 + 1,
    //æœ€å6ä½æ§åˆ¶é¢œè‰². ç”¨cssé€‰æ‹©å™¨: hue-rotateæ¥æ›´æ–°
    // 360åº¦:
    skinColorChoice: parseInt(dnaStr.substring(6, 8) / 100 * 360),
    eyeColorChoice: parseInt(dnaStr.substring(8, 10) / 100 * 360),
    clothesColorChoice: parseInt(dnaStr.substring(10, 12) / 100 * 360),
    zombieName: name,
    zombieDescription: "A Level 1 CryptoZombie",
  }
  return zombieDetails
}
```

æˆ‘ä»¬çš„ JavaScript æ‰€åšçš„å°±æ˜¯è·å–ç”±`zombieDetails`Â äº§ç”Ÿçš„æ•°æ®, å¹¶ä¸”åˆ©ç”¨æµè§ˆå™¨é‡Œçš„ JavaScript ç¥å¥‡åŠŸèƒ½ (æˆ‘ä»¬ç”¨ Vue.js)ï¼Œç½®æ¢å‡ºå›¾åƒä»¥åŠä½¿ç”¨CSSè¿‡æ»¤å™¨ã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„ä»£ç ã€‚



## Require

Â `require`ä½¿å¾—å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä¸æ»¡è¶³æŸäº›æ¡ä»¶æ—¶æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åœæ­¢æ‰§è¡Œï¼š

```
function sayHiToVitalik(string _name) public returns (string) {
  // æ¯”è¾ƒ _name æ˜¯å¦ç­‰äº "Vitalik". å¦‚æœä¸æˆç«‹ï¼ŒæŠ›å‡ºå¼‚å¸¸å¹¶ç»ˆæ­¢ç¨‹åº
  require(keccak256(_name) == keccak256("Vitalik"));
  // å¦‚æœè¿”å› true, è¿è¡Œå¦‚ä¸‹è¯­å¥
  return "Hi!";
}
```

å¦‚æœä½ è¿™æ ·è°ƒç”¨å‡½æ•°Â `sayHiToVitalikï¼ˆâ€œVitalikâ€ï¼‰`Â ,å®ƒä¼šè¿”å›â€œHiï¼â€ã€‚è€Œå¦‚æœè°ƒç”¨çš„æ—¶å€™ä½¿ç”¨äº†å…¶ä»–å‚æ•°ï¼Œå®ƒåˆ™ä¼šæŠ›å‡ºé”™è¯¯å¹¶åœæ­¢æ‰§è¡Œã€‚

å› æ­¤ï¼Œåœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¹‹å‰ï¼Œç”¨Â `require`Â éªŒè¯å‰ç½®æ¡ä»¶æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚

> æ³¨æ„ï¼š Solidity å¹¶==ä¸æ”¯æŒåŸç”Ÿçš„å­—ç¬¦ä¸²æ¯”è¾ƒ==, æˆ‘ä»¬åªèƒ½é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„ keccak256 å“ˆå¸Œå€¼æ¥è¿›è¡Œåˆ¤æ–­)

## ç»§æ‰¿ï¼ˆInheritanceï¼‰

å½“ä»£ç è¿‡äºå†—é•¿çš„æ—¶å€™ï¼Œæœ€å¥½å°†ä»£ç å’Œé€»è¾‘åˆ†æ‹†åˆ°å¤šä¸ªä¸åŒçš„åˆçº¦ä¸­ï¼Œä»¥ä¾¿äºç®¡ç†ã€‚

æœ‰ä¸ªè®© Solidity çš„ä»£ç æ˜“äºç®¡ç†çš„åŠŸèƒ½ï¼Œå°±æ˜¯åˆçº¦Â **_inheritance_**Â (ç»§æ‰¿)ï¼š

```
contract Doge {
  function catchphrase() public returns (string) {
    return "So Wow CryptoDoge";
  }
}

contract BabyDoge is Doge {
  function anotherCatchphrase() public returns (string) {
    return "Such Moon BabyDoge";
  }
}
```

ç”±äºÂ `BabyDoge`Â æ˜¯ä»Â `Doge`Â é‚£é‡ŒÂ **_inherits_**Â ï¼ˆç»§æ‰¿)è¿‡æ¥çš„ã€‚ è¿™æ„å‘³ç€å½“ä½ ç¼–è¯‘å’Œéƒ¨ç½²äº†Â `BabyDoge`ï¼Œå®ƒå°†å¯ä»¥è®¿é—®Â `catchphrase()`Â å’ŒÂ `anotherCatchphrase()`å’Œå…¶ä»–æˆ‘ä»¬åœ¨Â `Doge`Â ä¸­å®šä¹‰çš„å…¶ä»–å…¬å…±å‡½æ•°ã€‚

è¿™å¯ä»¥ç”¨äºé€»è¾‘ç»§æ‰¿ï¼ˆæ¯”å¦‚è¡¨è¾¾å­ç±»çš„æ—¶å€™ï¼Œ`Cat`Â æ˜¯ä¸€ç§Â `Animal`ï¼‰ã€‚ ä½†ä¹Ÿå¯ä»¥ç®€å•åœ°å°†ç±»ä¼¼çš„é€»è¾‘ç»„åˆåˆ°ä¸åŒçš„åˆçº¦ä¸­ä»¥ç»„ç»‡ä»£ç ã€‚

## å¯¼å…¥ï¼ˆImportï¼‰

åœ¨ Solidity ä¸­ï¼Œå½“ä½ æœ‰å¤šä¸ªæ–‡ä»¶å¹¶ä¸”æƒ³æŠŠä¸€ä¸ªæ–‡ä»¶å¯¼å…¥å¦ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Â `import`Â è¯­å¥ï¼š

```
import "./someothercontract.sol";

contract newContract is SomeOtherContract {
	// ...
}
```



## å˜é‡å­˜å‚¨

åœ¨ Solidity ä¸­ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥å­˜å‚¨å˜é‡ â€”â€”Â `storage`Â æˆ–Â `memory`ã€‚

**_Storage_**Â å˜é‡æ˜¯æŒ‡==æ°¸ä¹…å­˜å‚¨==åœ¨åŒºå—é“¾ä¸­çš„å˜é‡ã€‚Â **_Memory_**Â å˜é‡åˆ™æ˜¯ä¸´æ—¶çš„ï¼Œå½“å¤–éƒ¨å‡½æ•°å¯¹æŸåˆçº¦è°ƒç”¨å®Œæˆæ—¶ï¼Œå†…å­˜å‹å˜é‡å³è¢«ç§»é™¤ã€‚ ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå­˜å‚¨åœ¨ä½ ç”µè„‘çš„ç¡¬ç›˜æˆ–æ˜¯RAMä¸­æ•°æ®çš„å…³ç³»ã€‚

å¤§å¤šæ•°æ—¶å€™ä½ éƒ½ç”¨ä¸åˆ°è¿™äº›å…³é”®å­—ï¼Œé»˜è®¤æƒ…å†µä¸‹ Solidity ä¼šè‡ªåŠ¨å¤„ç†å®ƒä»¬ã€‚ 

*çŠ¶æ€å˜é‡*ï¼ˆåœ¨å‡½æ•°ä¹‹å¤–å£°æ˜çš„å˜é‡ï¼‰é»˜è®¤ä¸ºâ€œå­˜å‚¨â€å½¢å¼ï¼Œå¹¶æ°¸ä¹…å†™å…¥åŒºå—é“¾ï¼›è€Œåœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡æ˜¯â€œå†…å­˜â€å‹çš„ï¼Œå®ƒä»¬å‡½æ•°è°ƒç”¨ç»“æŸåæ¶ˆå¤±ã€‚

> ç„¶è€Œä¹Ÿæœ‰ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦æ‰‹åŠ¨å£°æ˜å­˜å‚¨ç±»å‹ï¼Œä¸»è¦ç”¨äºå¤„ç†å‡½æ•°å†…çš„Â **ç»“æ„ä½“**Â å’ŒÂ **æ•°ç»„**Â æ—¶ï¼š

```
contract SandwichFactory {
  struct Sandwich {
    string name;
    string status;
  }

  Sandwich[] sandwiches;

  function eatSandwich(uint _index) public {
    // Sandwich mySandwich = sandwiches[_index];
    // ^ çœ‹ä¸Šå»å¾ˆç›´æ¥ï¼Œä¸è¿‡ Solidity å°†ä¼šç»™å‡ºè­¦å‘Š
    // å‘Šè¯‰ä½ åº”è¯¥æ˜ç¡®åœ¨è¿™é‡Œå®šä¹‰ `storage` æˆ–è€… `memory`ã€‚

    // æ‰€ä»¥ä½ åº”è¯¥æ˜ç¡®å®šä¹‰ `storage`:
    Sandwich storage mySandwich = sandwiches[_index];
    // ...è¿™é‡Œ `mySandwich` æ˜¯æŒ‡å‘ `sandwiches[_index]`çš„æŒ‡é’ˆ
    mySandwich.status = "Eaten!";
    // ^è¿™å°†æ°¸ä¹…æŠŠ `sandwiches[_index]` å˜ä¸ºåŒºå—é“¾ä¸Šçš„å­˜å‚¨

    // å¦‚æœä½ åªæƒ³è¦ä¸€ä¸ªå‰¯æœ¬ï¼Œå¯ä»¥ä½¿ç”¨`memory`:
    Sandwich memory anotherSandwich = sandwiches[_index + 1];
    // ...è¿™æ · `anotherSandwich` å°±ä»…ä»…æ˜¯ä¸€ä¸ªå†…å­˜é‡Œçš„å‰¯æœ¬äº†
    anotherSandwich.status = "Eaten!";
    // ^è¿™å°†ä»…ä»…ä¿®æ”¹ä¸´æ—¶å˜é‡ï¼Œå¯¹ `sandwiches[_index + 1]` æ²¡æœ‰ä»»ä½•å½±å“
    // ä¸è¿‡ä½ å¯ä»¥è¿™æ ·åš:
    sandwiches[_index + 1] = anotherSandwich;
    // ...å¦‚æœä½ æƒ³æŠŠå‰¯æœ¬çš„æ”¹åŠ¨ä¿å­˜å›åŒºå—é“¾å­˜å‚¨
  }
}
```

å¦‚æœä½ è¿˜æ²¡æœ‰å®Œå…¨ç†è§£ç©¶ç«Ÿåº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒ â€”â€” åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å‘Šè¯‰ä½ ä½•æ—¶ä½¿ç”¨Â `storage`Â æˆ–æ˜¯Â `memory`ï¼Œå¹¶ä¸”å½“ä½ ä¸å¾—ä¸ä½¿ç”¨åˆ°è¿™äº›å…³é”®å­—çš„æ—¶å€™ï¼ŒSolidity ç¼–è¯‘å™¨ä¹Ÿå‘è­¦ç¤ºæé†’ä½ çš„ã€‚

ç°åœ¨ï¼Œåªè¦çŸ¥é“åœ¨æŸäº›åœºåˆä¸‹ä¹Ÿéœ€è¦ä½ æ˜¾å¼åœ°å£°æ˜Â `storage`Â æˆ–Â `memory`å°±å¤Ÿäº†ï¼

è¿˜æœ‰ä¸€ä¸ª **_Calldata_** ç±»å‹,ä¹Ÿæ˜¯å­˜åœ¨å†…å­˜é‡Œé¢ã€‚ä¸`memory`çš„ä¸åŒç‚¹åœ¨äº`calldata`å˜é‡ä¸èƒ½ä¿®æ”¹ï¼ˆ`immutable`ï¼‰ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°çš„å‚æ•°ã€‚

ä¾‹å­ï¼š

```
function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata){        
	//å‚æ•°ä¸ºcalldataæ•°ç»„ï¼Œä¸èƒ½è¢«ä¿®æ”¹        
	// _x[0] = 0 //è¿™æ ·ä¿®æ”¹ä¼šæŠ¥é”™        
	return(_x);    
}
```


åœ¨ä¸åŒå­˜å‚¨ç±»å‹ç›¸äº’èµ‹å€¼æ—¶å€™ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿç‹¬ç«‹çš„å‰¯æœ¬ï¼ˆä¿®æ”¹æ–°å˜é‡ä¸ä¼šå½±å“åŸå˜é‡ï¼‰ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿå¼•ç”¨ï¼ˆä¿®æ”¹æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ï¼‰ã€‚è§„åˆ™å¦‚ä¸‹ï¼š

1.  `storage`ï¼ˆåˆçº¦çš„çŠ¶æ€å˜é‡ï¼‰èµ‹å€¼ç»™æœ¬åœ° `storage`ï¼ˆå‡½æ•°é‡Œçš„ï¼‰æ—¶å€™ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚

2.  `storage` èµ‹å€¼ç»™ `memory` ï¼Œä¼šåˆ›å»ºç‹¬ç«‹çš„å¤æœ¬ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ªï¼›åä¹‹äº¦ç„¶ã€‚

3.  `memory` èµ‹å€¼ç»™ `memory` ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚

4.  å…¶ä»–æƒ…å†µï¼Œå˜é‡èµ‹å€¼ç»™ `storage` ï¼Œä¼šåˆ›å»ºç‹¬ç«‹çš„å¤æœ¬ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ªã€‚


## ä¸å…¶ä»–åˆçº¦çš„äº¤äº’

å¦‚æœæˆ‘ä»¬çš„åˆçº¦éœ€è¦å’ŒåŒºå—é“¾ä¸Šçš„å…¶ä»–çš„åˆçº¦ä¼šè¯ï¼Œåˆ™éœ€å…ˆå®šä¹‰ä¸€ä¸ªÂ **_interface_**Â (æ¥å£)ã€‚

å…ˆä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ã€‚ å‡è®¾åœ¨åŒºå—é“¾ä¸Šæœ‰è¿™ä¹ˆä¸€ä¸ªåˆçº¦ï¼š

```
contract LuckyNumber {
  mapping(address => uint) numbers;

  function setNum(uint _num) public {
    numbers[msg.sender] = _num;
  }

  function getNum(address _myAddress) public view returns (uint) {
    return numbers[_myAddress];
  }
}
```

è¿™æ˜¯ä¸ªå¾ˆç®€å•çš„åˆçº¦ï¼Œæ‚¨å¯ä»¥ç”¨å®ƒå­˜å‚¨è‡ªå·±çš„å¹¸è¿å·ç ï¼Œå¹¶å°†å…¶ä¸æ‚¨çš„ä»¥å¤ªåŠåœ°å€å…³è”ã€‚ è¿™æ ·å…¶ä»–äººå°±å¯ä»¥é€šè¿‡æ‚¨çš„åœ°å€æŸ¥æ‰¾æ‚¨çš„å¹¸è¿å·ç äº†ã€‚

ç°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤–éƒ¨åˆçº¦ï¼Œä½¿ç”¨Â `getNum`Â å‡½æ•°å¯è¯»å–å…¶ä¸­çš„æ•°æ®ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰Â `LuckyNumber`Â åˆçº¦çš„Â **_interface_**Â ï¼š

```
contract NumberInterface {
  function getNum(address _myAddress) public view returns (uint);
}
```

è¯·æ³¨æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹è™½ç„¶çœ‹èµ·æ¥åƒåœ¨å®šä¹‰ä¸€ä¸ªåˆçº¦ï¼Œä½†å…¶å®å†…é‡Œä¸åŒï¼š

é¦–å…ˆï¼Œæˆ‘ä»¬åªå£°æ˜äº†è¦ä¸ä¹‹äº¤äº’çš„å‡½æ•° â€”â€” åœ¨æœ¬ä¾‹ä¸­ä¸ºÂ `getNum`Â â€”â€” åœ¨å…¶ä¸­æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åˆ°ä»»ä½•å…¶ä»–çš„å‡½æ•°æˆ–çŠ¶æ€å˜é‡ã€‚

å…¶æ¬¡ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·ï¼ˆ`{`Â å’ŒÂ `}`ï¼‰å®šä¹‰å‡½æ•°ä½“ï¼Œæˆ‘ä»¬å•å•ç”¨åˆ†å·ï¼ˆ`;`ï¼‰ç»“æŸäº†å‡½æ•°å£°æ˜ã€‚è¿™ä½¿å®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªåˆçº¦æ¡†æ¶ã€‚

ç¼–è¯‘å™¨å°±æ˜¯é è¿™äº›ç‰¹å¾è®¤å‡ºå®ƒæ˜¯ä¸€ä¸ªæ¥å£çš„ã€‚

åœ¨æˆ‘ä»¬çš„ app ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œåˆçº¦å°±çŸ¥é“å…¶ä»–åˆçº¦çš„å‡½æ•°æ˜¯æ€æ ·çš„ï¼Œåº”è¯¥å¦‚ä½•è°ƒç”¨ï¼Œä»¥åŠå¯æœŸå¾…ä»€ä¹ˆç±»å‹çš„è¿”å›å€¼ã€‚

åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†çœŸæ­£è°ƒç”¨å…¶ä»–åˆçº¦çš„å‡½æ•°ã€‚ç›®å‰æˆ‘ä»¬åªè¦å£°æ˜ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè°ƒç”¨ CryptoKitties åˆçº¦å°±è¡Œäº†ã€‚

## ä½¿ç”¨æ¥å£

ç»§ç»­å‰é¢Â `NumberInterface`Â çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ—¢ç„¶å°†æ¥å£å®šä¹‰ä¸ºï¼š

```
contract NumberInterface {
  function getNum(address _myAddress) public view returns (uint);
}
```

æˆ‘ä»¬å¯ä»¥åœ¨åˆçº¦ä¸­è¿™æ ·ä½¿ç”¨ï¼š

```
contract MyContract {
  address NumberInterfaceAddress = 0xab38...;
  // ^ è¿™æ˜¯FavoriteNumberåˆçº¦åœ¨ä»¥å¤ªåŠä¸Šçš„åœ°å€
  NumberInterface numberContract = NumberInterface(NumberInterfaceAddress);
  // ç°åœ¨å˜é‡ `numberContract` æŒ‡å‘å¦ä¸€ä¸ªåˆçº¦å¯¹è±¡
  // (å³: ä½¿ç”¨ NumberInterfaceAddress åˆå§‹åŒ–)

  function someFunction() public {
    // ç°åœ¨æˆ‘ä»¬å¯ä»¥è°ƒç”¨åœ¨é‚£ä¸ªåˆçº¦ä¸­å£°æ˜çš„ `getNum`å‡½æ•°:
    uint num = numberContract.getNum(msg.sender);
    // ...åœ¨è¿™å„¿ä½¿ç”¨ `num`å˜é‡åšäº›ä»€ä¹ˆ
  }
}
```

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œåªè¦å°†æ‚¨åˆçº¦çš„å¯è§æ€§è®¾ç½®ä¸º`public`(å…¬å…±)æˆ–`external`(å¤–éƒ¨)ï¼Œå®ƒä»¬å°±å¯ä»¥ä¸ä»¥å¤ªåŠåŒºå—é“¾ä¸Šçš„ä»»ä½•å…¶ä»–åˆçº¦è¿›è¡Œäº¤äº’ã€‚

## å¤„ç†å¤šè¿”å›å€¼

`getKitty`
```
contract KittyInterface {
	function getKitty(uint256 _id) external view returns (
		bool isGestating,
		bool isReady,
		uint256 cooldownIndex,
		uint256 nextActionAt,
		uint256 siringWithId,
		uint256 birthTime,
		uint256 matronId,
		uint256 sireId,
		uint256 generation,
		uint256 genes
	);
}
```

`getKitty`Â æ˜¯æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ç¬¬ä¸€ä¸ªè¿”å›å¤šä¸ªå€¼çš„å‡½æ•°ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯å¦‚ä½•å¤„ç†çš„ï¼š

```
function multipleReturns() internal returns(uint a, uint b, uint c) {
  return (1, 2, 3);
}

function processMultipleReturns() external {
  uint a;
  uint b;
  uint c;
  // è¿™æ ·æ¥åšæ‰¹é‡èµ‹å€¼:
  (a, b, c) = multipleReturns();
}

// æˆ–è€…å¦‚æœæˆ‘ä»¬åªæƒ³è¿”å›å…¶ä¸­ä¸€ä¸ªå˜é‡:
function getLastReturnValue() external {
  uint c;
  // å¯ä»¥å¯¹å…¶ä»–å­—æ®µç•™ç©º:
  // æ„Ÿè§‰è¿™é‡Œæœ‰ç‚¹ç±»ä¼¼è§£æ„èµ‹å€¼é‚£ç§
  (,,c) = multipleReturns();
}
```

## if è¯­å¥

ifè¯­å¥çš„è¯­æ³•åœ¨ Solidity ä¸­ï¼Œä¸åœ¨ JavaScript ä¸­å·®ä¸å¤šï¼š

```
function eatBLT(string sandwich) public {
  // çœ‹æ¸…æ¥šäº†ï¼Œå½“æˆ‘ä»¬æ¯”è¾ƒå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œéœ€è¦æ¯”è¾ƒä»–ä»¬çš„ keccak256 å“ˆå¸Œç 
  if (keccak256(sandwich) == keccak256("BLT")) {
    eat();
  }
}
```

## JavaScript å®ç°

æˆ‘ä»¬åªç”¨ç¼–è¯‘å’Œéƒ¨ç½²Â `ZombieFeeding`ï¼Œå°±å¯ä»¥å°†è¿™ä¸ªåˆçº¦éƒ¨ç½²åˆ°ä»¥å¤ªåŠäº†ã€‚æˆ‘ä»¬æœ€ç»ˆå®Œæˆçš„è¿™ä¸ªåˆçº¦ç»§æ‰¿è‡ªÂ `ZombieFactory`ï¼Œå› æ­¤å®ƒå¯ä»¥è®¿é—®è‡ªå·±å’Œçˆ¶è¾ˆåˆçº¦ä¸­çš„æ‰€æœ‰ public æ–¹æ³•ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¸æˆ‘ä»¬çš„åˆšéƒ¨ç½²çš„åˆçº¦è¿›è¡Œäº¤äº’çš„ä¾‹å­ï¼Œ è¿™ä¸ªä¾‹å­ä½¿ç”¨äº† JavaScript å’Œ web3.jsï¼š

```
var abi = /* abi generated by the compiler */
var ZombieFeedingContract = web3.eth.contract(abi)
var contractAddress = /* our contract address on Ethereum after deploying */
var ZombieFeeding = ZombieFeedingContract.at(contractAddress)

// å‡è®¾æˆ‘ä»¬æœ‰æˆ‘ä»¬çš„åƒµå°¸IDå’Œè¦æ”»å‡»çš„çŒ«å’ªID
let zombieId = 1;
let kittyId = 1;

// è¦æ‹¿åˆ°çŒ«å’ªçš„DNAï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨å®ƒçš„APIã€‚è¿™äº›æ•°æ®ä¿å­˜åœ¨å®ƒä»¬çš„æœåŠ¡å™¨ä¸Šè€Œä¸æ˜¯åŒºå—é“¾ä¸Šã€‚
// å¦‚æœä¸€åˆ‡éƒ½åœ¨åŒºå—é“¾ä¸Šï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒå®ƒä»¬çš„æœåŠ¡å™¨æŒ‚äº†ï¼Œæˆ–è€…å®ƒä»¬ä¿®æ”¹äº†APIï¼Œ
// æˆ–è€…å› ä¸ºä¸å–œæ¬¢æˆ‘ä»¬çš„åƒµå°¸æ¸¸æˆè€Œå°æ€äº†æˆ‘ä»¬
let apiUrl = "https://api.cryptokitties.co/kitties/" + kittyId
$.get(apiUrl, function(data) {
  let imgUrl = data.image_url
  // ä¸€äº›æ˜¾ç¤ºå›¾ç‰‡çš„ä»£ç 
})

// å½“ç”¨æˆ·ç‚¹å‡»ä¸€åªçŒ«å’ªçš„æ—¶å€™:
$(".kittyImage").click(function(e) {
  // è°ƒç”¨æˆ‘ä»¬åˆçº¦çš„ `feedOnKitty` å‡½æ•°
  ZombieFeeding.feedOnKitty(zombieId, kittyId)
})

// ä¾¦å¬æ¥è‡ªæˆ‘ä»¬åˆçº¦çš„æ–°åƒµå°¸äº‹ä»¶å¥½æ¥å¤„ç†
ZombieFactory.NewZombie(function(error, result) {
  if (error) return
  // è¿™ä¸ªå‡½æ•°ç”¨æ¥æ˜¾ç¤ºåƒµå°¸:
  generateZombie(result.zombieId, result.name, result.dna)
})
```


## ç¬¬1ç« : æ™ºèƒ½åè®®çš„æ°¸å›ºæ€§

åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®²çš„ Solidity å’Œå…¶ä»–è¯­è¨€æ²¡æœ‰è´¨çš„åŒºåˆ«ï¼Œå®ƒé•¿å¾—ä¹Ÿå¾ˆåƒ JavaScriptã€‚

ä½†æ˜¯ï¼Œåœ¨æœ‰å‡ ç‚¹ä»¥å¤ªåŠä¸Šçš„ DApp è·Ÿæ™®é€šçš„åº”ç”¨ç¨‹åºæœ‰ç€å¤©å£¤ä¹‹åˆ«ã€‚

ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ä½ æŠŠæ™ºèƒ½åè®®ä¼ ä¸Šä»¥å¤ªåŠä¹‹åï¼Œå®ƒå°±å˜å¾—**_ä¸å¯æ›´æ”¹_**, è¿™ç§æ°¸å›ºæ€§æ„å‘³ç€ä½ çš„ä»£ç æ°¸è¿œä¸èƒ½è¢«è°ƒæ•´æˆ–æ›´æ–°ã€‚

ä½ ç¼–è¯‘çš„ç¨‹åºä¼šä¸€ç›´ï¼Œæ°¸ä¹…çš„ï¼Œä¸å¯æ›´æ”¹çš„ï¼Œå­˜åœ¨ä»¥å¤ªåŠä¸Šã€‚è¿™å°±æ˜¯ Solidity ä»£ç çš„å®‰å…¨æ€§å¦‚æ­¤é‡è¦çš„ä¸€ä¸ªåŸå› ã€‚å¦‚æœä½ çš„æ™ºèƒ½åè®®æœ‰ä»»ä½•æ¼æ´ï¼Œå³ä½¿ä½ å‘ç°äº†ä¹Ÿæ— æ³•è¡¥æ•‘ã€‚ä½ åªèƒ½è®©ä½ çš„ç”¨æˆ·ä»¬æ”¾å¼ƒè¿™ä¸ªæ™ºèƒ½åè®®ï¼Œç„¶åè½¬ç§»åˆ°ä¸€ä¸ªæ–°çš„ä¿®å¤åçš„åˆçº¦ä¸Šã€‚

ä½†è¿™æ°å¥½ä¹Ÿæ˜¯æ™ºèƒ½åˆçº¦çš„ä¸€å¤§ä¼˜åŠ¿ã€‚ä»£ç è¯´æ˜ä¸€åˆ‡ã€‚å¦‚æœä½ å»è¯»æ™ºèƒ½åˆçº¦çš„ä»£ç ï¼Œå¹¶éªŒè¯å®ƒï¼Œä½ ä¼šå‘ç°ï¼Œä¸€æ—¦å‡½æ•°è¢«å®šä¹‰ä¸‹æ¥ï¼Œæ¯ä¸€æ¬¡çš„è¿è¡Œï¼Œç¨‹åºéƒ½ä¼šä¸¥æ ¼éµç…§å‡½æ•°ä¸­åŸæœ‰çš„ä»£ç é€»è¾‘ä¸€ä¸ä¸è‹Ÿåœ°æ‰§è¡Œï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒå‡½æ•°è¢«äººç¯¡æ”¹è€Œå¾—åˆ°æ„å¤–çš„ç»“æœã€‚

## å¤–éƒ¨ä¾èµ–å…³ç³»

åœ¨ç¬¬2è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†åŠ å¯†å°çŒ«ï¼ˆCryptoKittiesï¼‰åˆçº¦çš„åœ°å€ç¡¬ç¼–ç åˆ° DApp ä¸­å»äº†ã€‚æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¦‚æœåŠ å¯†å°çŒ«å‡ºäº†ç‚¹é—®é¢˜ï¼Œæ¯”æ–¹è¯´ï¼Œé›†ä½“æ¶ˆå¤±äº†ä¼šæ€ä¹ˆæ ·ï¼Ÿ è™½ç„¶è¿™ç§äº‹æƒ…å‡ ä¹ä¸å¯èƒ½å‘ç”Ÿï¼Œä½†æ˜¯ï¼Œå¦‚æœå°çŒ«æ²¡äº†ï¼Œæˆ‘ä»¬çš„ DApp ä¹Ÿä¼šéšä¹‹å¤±æ•ˆ -- å› ä¸ºæˆ‘ä»¬åœ¨ DApp çš„ä»£ç ä¸­ç”¨â€œç¡¬ç¼–ç â€çš„æ–¹å¼æŒ‡å®šäº†åŠ å¯†å°çŒ«çš„åœ°å€ï¼Œå¦‚æœè¿™ä¸ªæ ¹æ®åœ°å€æ‰¾ä¸åˆ°å°çŒ«ï¼Œæˆ‘ä»¬çš„åƒµå°¸ä¹Ÿå°±åƒä¸åˆ°å°çŒ«äº†ï¼Œè€ŒæŒ‰ç…§å‰é¢çš„æè¿°ï¼Œæˆ‘ä»¬å´æ²¡æ³•ä¿®æ”¹åˆçº¦å»åº”ä»˜è¿™ä¸ªå˜åŒ–ï¼

å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½ç¡¬ç¼–ç ï¼Œè€Œè¦é‡‡ç”¨â€œå‡½æ•°â€ï¼Œä»¥ä¾¿äº DApp çš„å…³é”®éƒ¨åˆ†å¯ä»¥ä»¥å‚æ•°å½¢å¼ä¿®æ”¹ã€‚

æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬ä¸å†ä¸€å¼€å§‹å°±æŠŠçŒç‰©åœ°å€ç»™å†™å…¥ä»£ç ï¼Œè€Œæ˜¯å†™ä¸ªå‡½æ•°Â `setKittyContractAddress`, è¿è¡Œæ—¶å†è®¾å®šçŒç‰©çš„åœ°å€ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éšæ—¶å»é”å®šæ–°çš„çŒç‰©ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒåŠ å¯†å°çŒ«é›†ä½“æ¶ˆå¤±äº†ã€‚


å¦‚æœä¸€ä¸ªå‡½æ•°çš„å¯è§æ€§ç”³æ˜ä¸ºâ€œå¤–éƒ¨çš„â€ï¼ˆ`external`ï¼‰ï¼Œä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨å®ƒï¼ ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•è°ƒç”¨è¯¥å‡½æ•°çš„äººéƒ½å¯ä»¥æ›´æ”¹ CryptoKitties åˆçº¦çš„åœ°å€ï¼Œä½¿å¾—å…¶ä»–äººéƒ½æ²¡æ³•å†è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºäº†ã€‚

æˆ‘ä»¬ç¡®å®æ˜¯å¸Œæœ›è¿™ä¸ªåœ°å€èƒ½å¤Ÿåœ¨åˆçº¦ä¸­ä¿®æ”¹ï¼Œä½†æˆ‘å¯æ²¡è¯´è®©æ¯ä¸ªäººå»æ”¹å®ƒå‘€ã€‚

è¦å¯¹ä»˜è¿™æ ·çš„æƒ…å†µï¼Œé€šå¸¸çš„åšæ³•æ˜¯æŒ‡å®šåˆçº¦çš„â€œæ‰€æœ‰æƒâ€ - å°±æ˜¯è¯´ï¼Œç»™å®ƒæŒ‡å®šä¸€ä¸ªä¸»äººï¼ˆæ²¡é”™ï¼Œå°±æ˜¯æ‚¨ï¼‰ï¼Œåªæœ‰ä¸»äººå¯¹å®ƒäº«æœ‰ç‰¹æƒã€‚

## OpenZeppelinåº“çš„`Ownable`Â åˆçº¦

ä¸‹é¢æ˜¯ä¸€ä¸ªÂ `Ownable`Â åˆçº¦çš„ä¾‹å­ï¼š æ¥è‡ªÂ **_ OpenZeppelin _**Â Solidity åº“çš„Â `Ownable`Â åˆçº¦ã€‚ OpenZeppelin æ˜¯ä¸»æ‰“å®‰ä¿å’Œç¤¾åŒºå®¡æŸ¥çš„æ™ºèƒ½åˆçº¦åº“ï¼Œæ‚¨å¯ä»¥åœ¨è‡ªå·±çš„ DAppsä¸­å¼•ç”¨ã€‚ç­‰æŠŠè¿™ä¸€è¯¾å­¦å®Œï¼Œæ‚¨ä¸è¦å‚¬æˆ‘ä»¬å‘å¸ƒä¸‹ä¸€è¯¾ï¼Œæœ€å¥½åˆ©ç”¨è¿™ä¸ªæ—¶é—´æŠŠ OpenZeppelin çš„ç½‘ç«™çœ‹çœ‹ï¼Œä¿ç®¡æ‚¨ä¼šå­¦åˆ°å¾ˆå¤šä¸œè¥¿ï¼

æŠŠæ¥¼ä¸‹è¿™ä¸ªåˆçº¦è¯»è¯»é€šï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰äº›æ²¡è§è¿‡ä»£ç ï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬éšåä¼šè§£é‡Šã€‚

```
/**
 * @title Ownable
 * @dev The Ownable contract has an owner address, and provides basic authorization control
 * functions, this simplifies the implementation of "user permissions".
 */
contract Ownable {
  address public owner;
  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);

  /**
   * @dev The Ownable constructor sets the original `owner` of the contract to the sender
   * account.
   */
  function Ownable() public {
    owner = msg.sender;
  }

  /**
   * @dev Throws if called by any account other than the owner.
   */
  modifier onlyOwner() {
    require(msg.sender == owner);
    _;
  }

  /**
   * @dev Allows the current owner to transfer control of the contract to a newOwner.
   * @param newOwner The address to transfer ownership to.
   */
  function transferOwnership(address newOwner) public onlyOwner {
    require(newOwner != address(0));
    OwnershipTransferred(owner, newOwner);
    owner = newOwner;
  }
}
```

ä¸‹é¢æœ‰æ²¡æœ‰æ‚¨æ²¡å­¦è¿‡çš„ä¸œä¸œï¼Ÿ

-   æ„é€ å‡½æ•°ï¼š`function Ownable()`æ˜¯ä¸€ä¸ªÂ **_ constructor_**Â (æ„é€ å‡½æ•°)ï¼Œæ„é€ å‡½æ•°ä¸æ˜¯å¿…é¡»çš„ï¼Œå®ƒä¸åˆçº¦åŒåï¼Œæ„é€ å‡½æ•°ä¸€ç”Ÿä¸­å”¯ä¸€çš„ä¸€æ¬¡æ‰§è¡Œï¼Œå°±æ˜¯åœ¨åˆçº¦æœ€åˆè¢«åˆ›å»ºçš„æ—¶å€™ã€‚
    
-   å‡½æ•°ä¿®é¥°ç¬¦ï¼š`modifier onlyOwner()`ã€‚ ä¿®é¥°ç¬¦è·Ÿå‡½æ•°å¾ˆç±»ä¼¼ï¼Œä¸è¿‡æ˜¯ç”¨æ¥ä¿®é¥°å…¶ä»–å·²æœ‰å‡½æ•°ç”¨çš„ï¼Œ åœ¨å…¶ä»–è¯­å¥æ‰§è¡Œå‰ï¼Œä¸ºå®ƒæ£€æŸ¥ä¸‹å…ˆéªŒæ¡ä»¶ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™ä¸ªä¿®é¥°ç¬¦Â `onlyOwner`Â æ£€æŸ¥ä¸‹è°ƒç”¨è€…ï¼Œç¡®ä¿åªæœ‰åˆçº¦çš„ä¸»äººæ‰èƒ½è¿è¡Œæœ¬å‡½æ•°ã€‚æˆ‘ä»¬ä¸‹ä¸€ç« ä¸­ä¼šè¯¦ç»†è®²è¿°ä¿®é¥°ç¬¦ï¼Œä»¥åŠé‚£ä¸ªå¥‡æ€ªçš„`_;`ã€‚
    
-   `indexed`Â å…³é”®å­—ï¼šåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬è¿˜ç”¨ä¸åˆ°å®ƒã€‚
    

æ‰€ä»¥`Ownable`Â åˆçº¦åŸºæœ¬éƒ½ä¼šè¿™ä¹ˆå¹²ï¼š

1.  åˆçº¦åˆ›å»ºï¼Œæ„é€ å‡½æ•°å…ˆè¡Œï¼Œå°†å…¶Â `owner`Â è®¾ç½®ä¸º`msg.sender`ï¼ˆå…¶éƒ¨ç½²è€…ï¼‰
    
2.  ä¸ºå®ƒåŠ ä¸Šä¸€ä¸ªä¿®é¥°ç¬¦Â `onlyOwner`ï¼Œå®ƒä¼šé™åˆ¶é™Œç”Ÿäººçš„è®¿é—®ï¼Œå°†è®¿é—®æŸäº›å‡½æ•°çš„æƒé™é”å®šåœ¨Â `owner`Â ä¸Šã€‚
    
3.  å…è®¸å°†åˆçº¦æ‰€æœ‰æƒè½¬è®©ç»™ä»–äººã€‚

`onlyOwner`Â ç®€ç›´äººè§äººçˆ±ï¼Œå¤§å¤šæ•°äººå¼€å‘è‡ªå·±çš„ Solidity DAppsï¼Œéƒ½æ˜¯ä»å¤åˆ¶/ç²˜è´´Â `Ownable`Â å¼€å§‹çš„ï¼Œä»å®ƒå†ç»§æ‰¿å‡ºçš„å­ç±»ï¼Œå¹¶åœ¨ä¹‹ä¸Šè¿›è¡ŒåŠŸèƒ½å¼€å‘ã€‚

æ—¢ç„¶æˆ‘ä»¬æƒ³æŠŠÂ `setKittyContractAddress`Â é™åˆ¶ä¸ºÂ `onlyOwner`Â ï¼Œæˆ‘ä»¬ä¹Ÿè¦åšåŒæ ·çš„äº‹æƒ…ã€‚

## å‡½æ•°ä¿®é¥°ç¬¦

å‡½æ•°ä¿®é¥°ç¬¦çœ‹èµ·æ¥è·Ÿå‡½æ•°æ²¡ä»€ä¹ˆä¸åŒï¼Œä¸è¿‡å…³é”®å­—`modifier`Â å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™æ˜¯ä¸ª`modifier(ä¿®é¥°ç¬¦)`ï¼Œè€Œä¸æ˜¯ä¸ª`function(å‡½æ•°)`ã€‚å®ƒä¸èƒ½åƒå‡½æ•°é‚£æ ·è¢«ç›´æ¥è°ƒç”¨ï¼Œåªèƒ½è¢«æ·»åŠ åˆ°å‡½æ•°å®šä¹‰çš„æœ«å°¾ï¼Œç”¨ä»¥æ”¹å˜å‡½æ•°çš„è¡Œä¸ºã€‚

å’±ä»¬ä»”ç»†è¯»è¯»Â `onlyOwner`:

```
/**
 * @dev è°ƒç”¨è€…ä¸æ˜¯â€˜ä¸»äººâ€™ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸
 */
modifier onlyOwner() {
  require(msg.sender == owner);
  _;
}
```

`onlyOwner`Â å‡½æ•°ä¿®é¥°ç¬¦æ˜¯è¿™ä¹ˆç”¨çš„ï¼š

```
contract MyContract is Ownable {
  event LaughManiacally(string laughter);

  //æ³¨æ„ï¼ `onlyOwner`ä¸Šåœº :
  function likeABoss() external onlyOwner {
    LaughManiacally("Muahahahaha");
  }
}
```

æ³¨æ„Â `likeABoss`Â å‡½æ•°ä¸Šçš„Â `onlyOwner`Â ä¿®é¥°ç¬¦ã€‚ å½“ä½ è°ƒç”¨Â `likeABoss`Â æ—¶ï¼Œ**é¦–å…ˆæ‰§è¡Œ**Â `onlyOwner`Â ä¸­çš„ä»£ç ï¼Œ æ‰§è¡Œåˆ°Â `onlyOwner`Â ä¸­çš„Â `_;`Â è¯­å¥æ—¶ï¼Œç¨‹åºå†è¿”å›å¹¶æ‰§è¡ŒÂ `likeABoss`Â ä¸­çš„ä»£ç ã€‚

å¯è§ï¼Œå°½ç®¡å‡½æ•°ä¿®é¥°ç¬¦ä¹Ÿå¯ä»¥åº”ç”¨åˆ°å„ç§åœºåˆï¼Œä½†æœ€å¸¸è§çš„è¿˜æ˜¯æ”¾åœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰æ·»åŠ å¿«é€Ÿçš„Â `require`æ£€æŸ¥ã€‚

å› ä¸ºç»™å‡½æ•°æ·»åŠ äº†ä¿®é¥°ç¬¦Â `onlyOwner`ï¼Œä½¿å¾—**å”¯æœ‰åˆçº¦çš„ä¸»äºº**ï¼ˆä¹Ÿå°±æ˜¯éƒ¨ç½²è€…ï¼‰æ‰èƒ½è°ƒç”¨å®ƒã€‚

> æ³¨æ„ï¼šä¸»äººå¯¹åˆçº¦äº«æœ‰çš„ç‰¹æƒå½“ç„¶æ˜¯æ­£å½“çš„ï¼Œä¸è¿‡ä¹Ÿå¯èƒ½è¢«æ¶æ„ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œä¸‡ä¸€ï¼Œä¸»äººæ·»åŠ äº†ä¸ªåé—¨ï¼Œå…è®¸ä»–å·èµ°åˆ«äººçš„åƒµå°¸å‘¢ï¼Ÿ

> æ‰€ä»¥éå¸¸é‡è¦çš„æ˜¯ï¼Œéƒ¨ç½²åœ¨ä»¥å¤ªåŠä¸Šçš„ DAppï¼Œå¹¶ä¸èƒ½ä¿è¯å®ƒçœŸæ­£åšåˆ°å»ä¸­å¿ƒï¼Œä½ éœ€è¦é˜…è¯»å¹¶ç†è§£å®ƒçš„æºä»£ç ï¼Œæ‰èƒ½é˜²æ­¢å…¶ä¸­æ²¡æœ‰è¢«éƒ¨ç½²è€…æ¶æ„æ¤å…¥åé—¨ï¼›ä½œä¸ºå¼€å‘äººå‘˜ï¼Œå¦‚ä½•åšåˆ°æ—¢è¦ç»™è‡ªå·±ç•™ä¸‹ä¿®å¤ bug çš„ä½™åœ°ï¼Œåˆè¦å°½é‡åœ°æ”¾æƒç»™ä½¿ç”¨è€…ï¼Œä»¥ä¾¿è®©ä»–ä»¬æ”¾å¿ƒä½ ï¼Œä»è€Œæ„¿æ„æŠŠæ•°æ®æ”¾åœ¨ä½ çš„ DApp ä¸­ï¼Œè¿™ç¡®å®éœ€è¦ä¸ªå¾®å¦™çš„å¹³è¡¡ã€‚


## ç¬¬4ç« : Gas

å‰å®³ï¼ç°åœ¨æˆ‘ä»¬æ‡‚äº†å¦‚ä½•åœ¨ç¦æ­¢ç¬¬ä¸‰æ–¹ä¿®æ”¹æˆ‘ä»¬çš„åˆçº¦çš„åŒæ—¶ï¼Œç•™ä¸ªåé—¨ç»™å’±ä»¬è‡ªå·±å»ä¿®æ”¹ã€‚

è®©æˆ‘ä»¬æ¥çœ‹å¦ä¸€ç§ä½¿å¾— Solidity ç¼–ç¨‹è¯­è¨€ä¸ä¼—ä¸åŒçš„ç‰¹å¾ï¼š

### Gas - é©±åŠ¨ä»¥å¤ªåŠDAppsçš„èƒ½æº

åœ¨ Solidity ä¸­ï¼Œä½ çš„ç”¨æˆ·æƒ³è¦æ¯æ¬¡æ‰§è¡Œä½ çš„ DApp éƒ½éœ€è¦æ”¯ä»˜ä¸€å®šçš„Â **_gas_**ï¼Œgas å¯ä»¥ç”¨ä»¥å¤ªå¸è´­ä¹°ï¼Œå› æ­¤ï¼Œç”¨æˆ·æ¯æ¬¡è·‘ DApp éƒ½å¾—èŠ±è´¹ä»¥å¤ªå¸ã€‚

ä¸€ä¸ª DApp æ”¶å–å¤šå°‘ gas å–å†³äºåŠŸèƒ½é€»è¾‘çš„å¤æ‚ç¨‹åº¦ã€‚æ¯ä¸ªæ“ä½œèƒŒåï¼Œéƒ½åœ¨è®¡ç®—å®Œæˆè¿™ä¸ªæ“ä½œæ‰€éœ€è¦çš„è®¡ç®—èµ„æºï¼Œï¼ˆæ¯”å¦‚ï¼Œå­˜å‚¨æ•°æ®å°±æ¯”åšä¸ªåŠ æ³•è¿ç®—è´µå¾—å¤šï¼‰ï¼Œ ä¸€æ¬¡æ“ä½œæ‰€éœ€è¦èŠ±è´¹çš„Â **_gas_**Â ç­‰äºè¿™ä¸ªæ“ä½œèƒŒåçš„æ‰€æœ‰è¿ç®—èŠ±é”€çš„æ€»å’Œã€‚

ç”±äºè¿è¡Œä½ çš„ç¨‹åºéœ€è¦èŠ±è´¹ç”¨æˆ·çš„çœŸé‡‘ç™½é“¶ï¼Œåœ¨ä»¥å¤ªåŠä¸­ä»£ç çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ¯”å…¶ä»–ä»»ä½•ç¼–ç¨‹è¯­è¨€éƒ½æ›´å¼ºè°ƒä¼˜åŒ–ã€‚åŒæ ·çš„åŠŸèƒ½ï¼Œä½¿ç”¨ç¬¨æ‹™çš„ä»£ç å¼€å‘çš„ç¨‹åºï¼Œæ¯”èµ·ç»è¿‡ç²¾å·§ä¼˜åŒ–çš„ä»£ç æ¥ï¼Œè¿è¡ŒèŠ±è´¹æ›´é«˜ï¼Œè¿™æ˜¾ç„¶ä¼šç»™æˆåƒä¸Šä¸‡çš„ç”¨æˆ·å¸¦æ¥å¤§é‡ä¸å¿…è¦çš„å¼€é”€ã€‚

### ä¸ºä»€ä¹ˆè¦ç”¨Â **_gas_**Â æ¥é©±åŠ¨ï¼Ÿ

ä»¥å¤ªåŠå°±åƒä¸€ä¸ªå·¨å¤§ã€ç¼“æ…¢ã€ä½†éå¸¸å®‰å…¨çš„ç”µè„‘ã€‚å½“ä½ è¿è¡Œä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œç½‘ç»œä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åœ¨è¿›è¡Œç›¸åŒçš„è¿ç®—ï¼Œä»¥éªŒè¯å®ƒçš„è¾“å‡º â€”â€” è¿™å°±æ˜¯æ‰€è°“çš„â€œå»ä¸­å¿ƒåŒ–â€ ç”±äºæ•°ä»¥åƒè®¡çš„èŠ‚ç‚¹åŒæ—¶åœ¨éªŒè¯ç€æ¯ä¸ªåŠŸèƒ½çš„è¿è¡Œï¼Œè¿™å¯ä»¥ç¡®ä¿å®ƒçš„æ•°æ®ä¸ä¼šè¢«è¢«ç›‘æ§ï¼Œæˆ–è€…è¢«åˆ»æ„ä¿®æ”¹ã€‚

å¯èƒ½ä¼šæœ‰ç”¨æˆ·ç”¨æ— é™å¾ªç¯å µå¡ç½‘ç»œï¼ŒæŠ‘æˆ–ç”¨å¯†é›†è¿ç®—æ¥å ç”¨å¤§é‡çš„ç½‘ç»œèµ„æºï¼Œä¸ºäº†é˜²æ­¢è¿™ç§äº‹æƒ…çš„å‘ç”Ÿï¼Œä»¥å¤ªåŠçš„åˆ›å»ºè€…ä¸ºä»¥å¤ªåŠä¸Šçš„èµ„æºåˆ¶å®šäº†ä»·æ ¼ï¼Œæƒ³è¦åœ¨ä»¥å¤ªåŠä¸Šè¿ç®—æˆ–è€…å­˜å‚¨ï¼Œä½ éœ€è¦å…ˆä»˜è´¹ã€‚

> æ³¨æ„ï¼šå¦‚æœä½ ä½¿ç”¨ä¾§é“¾ï¼Œå€’æ˜¯ä¸ä¸€å®šéœ€è¦ä»˜è´¹ï¼Œæ¯”å¦‚å’±ä»¬åœ¨ Loom Network ä¸Šæ„å»ºçš„ CryptoZombies å°±å…è´¹ã€‚ä½ ä¸ä¼šæƒ³è¦åœ¨ä»¥å¤ªåŠä¸»ç½‘ä¸Šç©å„¿â€œé­”å…½ä¸–ç•Œâ€å§ï¼Ÿ - æ‰€éœ€è¦çš„ gas å¯èƒ½ä¼šä¹°åˆ°ä½ ç ´äº§ã€‚ä½†æ˜¯ä½ å¯ä»¥æ‰¾ä¸ªç®—æ³•ç†å¿µä¸åŒçš„ä¾§é“¾æ¥ç©å®ƒã€‚æˆ‘ä»¬å°†åœ¨ä»¥åçš„è¯¾ç¨‹ä¸­å’±ä»¬ä¼šè®¨è®ºåˆ°ï¼Œä»€ä¹ˆæ ·çš„ DApp åº”è¯¥éƒ¨ç½²åœ¨å¤ªåŠä¸»é“¾ä¸Šï¼Œä»€ä¹ˆåˆæœ€å¥½æ”¾åœ¨ä¾§é“¾ã€‚

### çœ gas çš„æ‹›æ•°ï¼šç»“æ„å°è£… ï¼ˆStruct packingï¼‰

åœ¨ç¬¬1è¯¾ä¸­ï¼Œæˆ‘ä»¬æåˆ°é™¤äº†åŸºæœ¬ç‰ˆçš„Â `uint`Â å¤–ï¼Œè¿˜æœ‰å…¶ä»–å˜ç§Â `uint`ï¼š`uint8`ï¼Œ`uint16`ï¼Œ`uint32`ç­‰ã€‚

é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸ä¼šè€ƒè™‘ä½¿ç”¨Â `uint`Â å˜ç§ï¼Œå› ä¸ºæ— è®ºå¦‚ä½•å®šä¹‰Â `uint`çš„å¤§å°ï¼ŒSolidity ä¸ºå®ƒä¿ç•™256ä½çš„å­˜å‚¨ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨Â `uint8`Â è€Œä¸æ˜¯`uint`ï¼ˆ`uint256`ï¼‰ä¸ä¼šä¸ºä½ èŠ‚çœä»»ä½• gasã€‚

é™¤éï¼ŒæŠŠÂ `uint`Â ç»‘å®šåˆ°Â `struct`Â é‡Œé¢ã€‚

å¦‚æœä¸€ä¸ªÂ `struct`Â ä¸­æœ‰å¤šä¸ªÂ `uint`ï¼Œåˆ™å°½å¯èƒ½ä½¿ç”¨è¾ƒå°çš„Â `uint`, Solidity ä¼šå°†è¿™äº›Â `uint`Â æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œä»è€Œå ç”¨è¾ƒå°‘çš„å­˜å‚¨ç©ºé—´ã€‚ä¾‹å¦‚ï¼š

```
struct NormalStruct {
  uint a;
  uint b;
  uint c;
}

struct MiniMe {
  uint32 a;
  uint32 b;
  uint c;
}

// å› ä¸ºä½¿ç”¨äº†ç»“æ„æ‰“åŒ…ï¼Œ`mini` æ¯” `normal` å ç”¨çš„ç©ºé—´æ›´å°‘
NormalStruct normal = NormalStruct(10, 20, 30);
MiniMe mini = MiniMe(10, 20, 30); 
```

æ‰€ä»¥ï¼Œå½“Â `uint`Â å®šä¹‰åœ¨ä¸€ä¸ªÂ `struct`Â ä¸­çš„æ—¶å€™ï¼Œå°½é‡ä½¿ç”¨æœ€å°çš„æ•´æ•°å­ç±»å‹ä»¥èŠ‚çº¦ç©ºé—´ã€‚ å¹¶ä¸”æŠŠåŒæ ·ç±»å‹çš„å˜é‡æ”¾ä¸€èµ·ï¼ˆå³åœ¨ struct ä¸­å°†æŠŠå˜é‡æŒ‰ç…§ç±»å‹ä¾æ¬¡æ”¾ç½®ï¼‰ï¼Œè¿™æ · Solidity å¯ä»¥å°†å­˜å‚¨ç©ºé—´æœ€å°åŒ–ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸¤ä¸ªÂ `struct`ï¼š

`uint c; uint32 a; uint32 b;`Â å’ŒÂ `uint32 a; uint c; uint32 b;`

å‰è€…æ¯”åè€…éœ€è¦çš„gasæ›´å°‘ï¼Œå› ä¸ºå‰è€…æŠŠ`uint32`æ”¾ä¸€èµ·äº†ã€‚

## ç¬¬5ç« : æ—¶é—´å•ä½

`level`Â å±æ€§è¡¨ç¤ºåƒµå°¸çš„çº§åˆ«ã€‚ä»¥åï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºçš„æˆ˜æ–—ç³»ç»Ÿä¸­ï¼Œæ‰“èƒœä»—çš„åƒµå°¸ä¼šé€æ¸å‡çº§å¹¶è·å¾—æ›´å¤šçš„èƒ½åŠ›ã€‚

`readyTime`Â ç¨å¾®å¤æ‚ç‚¹ã€‚æˆ‘ä»¬å¸Œæœ›å¢åŠ ä¸€ä¸ªâ€œå†·å´å‘¨æœŸâ€ï¼Œè¡¨ç¤ºåƒµå°¸åœ¨ä¸¤æ¬¡çŒé£Ÿæˆ–æ”»å‡»ä¹‹ä¹‹é—´å¿…é¡»ç­‰å¾…çš„æ—¶é—´ã€‚å¦‚æœæ²¡æœ‰å®ƒï¼Œåƒµå°¸æ¯å¤©å¯èƒ½ä¼šæ”»å‡»å’Œç¹æ®–1,000æ¬¡ï¼Œè¿™æ ·æ¸¸æˆå°±å¤ªç®€å•äº†ã€‚

ä¸ºäº†è®°å½•åƒµå°¸åœ¨ä¸‹ä¸€æ¬¡è¿›å‡»å‰éœ€è¦ç­‰å¾…çš„æ—¶é—´ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Solidity çš„æ—¶é—´å•ä½ã€‚

### æ—¶é—´å•ä½

Solidity ä½¿ç”¨è‡ªå·±çš„æœ¬åœ°æ—¶é—´å•ä½ã€‚

å˜é‡Â `now`Â å°†è¿”å›å½“å‰çš„unixæ—¶é—´æˆ³ï¼ˆè‡ª1970å¹´1æœˆ1æ—¥ä»¥æ¥ç»è¿‡çš„ç§’æ•°ï¼‰ï¼ŒÂ `now`Â è¿”å›ç±»å‹æ˜¯ `uint256` ã€‚
> æ³¨æ„ï¼šUnixæ—¶é—´ä¼ ç»Ÿç”¨ä¸€ä¸ª32ä½çš„æ•´æ•°è¿›è¡Œå­˜å‚¨ã€‚è¿™ä¼šå¯¼è‡´â€œ2038å¹´â€é—®é¢˜ï¼Œå½“è¿™ä¸ª32ä½çš„unixæ—¶é—´æˆ³ä¸å¤Ÿç”¨ï¼Œäº§ç”Ÿæº¢å‡ºï¼Œä½¿ç”¨è¿™ä¸ªæ—¶é—´çš„é—ç•™ç³»ç»Ÿå°±éº»çƒ¦äº†ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©æˆ‘ä»¬çš„ DApp è·‘å¤Ÿ20å¹´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨64ä½æ•´æ•°è¡¨ç¤ºæ—¶é—´ï¼Œä½†ä¸ºæ­¤æˆ‘ä»¬çš„ç”¨æˆ·åˆå¾—æ”¯ä»˜æ›´å¤šçš„ gasã€‚çœŸæ˜¯ä¸ªä¸¤éš¾çš„è®¾è®¡å•Šï¼

Solidity è¿˜åŒ…å«`ç§’(seconds)`ï¼Œ`åˆ†é’Ÿ(minutes)`ï¼Œ`å°æ—¶(hours)`ï¼Œ`å¤©(days)`ï¼Œ`å‘¨(weeks)`Â å’ŒÂ `å¹´(years)`Â ç­‰æ—¶é—´å•ä½ã€‚å®ƒä»¬éƒ½ä¼šè½¬æ¢æˆå¯¹åº”çš„ç§’æ•°æ”¾å…¥Â `uint`Â ä¸­ã€‚æ‰€ä»¥Â `1åˆ†é’Ÿ`Â å°±æ˜¯Â `60`ï¼Œ`1å°æ—¶`æ˜¯Â `3600`ï¼ˆ60ç§’Ã—60åˆ†é’Ÿï¼‰ï¼Œ`1å¤©`æ˜¯`86400`ï¼ˆ24å°æ—¶Ã—60åˆ†é’ŸÃ—60ç§’ï¼‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚

ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨æ—¶é—´å•ä½çš„å®ç”¨æ¡ˆä¾‹ï¼š

```
uint lastUpdated;

// å°†â€˜ä¸Šæ¬¡æ›´æ–°æ—¶é—´â€™ è®¾ç½®ä¸º â€˜ç°åœ¨â€™
function updateTimestamp() public {
  lastUpdated = now;
}

// å¦‚æœåˆ°ä¸Šæ¬¡`updateTimestamp` è¶…è¿‡5åˆ†é’Ÿï¼Œè¿”å› 'true'
// ä¸åˆ°5åˆ†é’Ÿè¿”å› 'false'
function fiveMinutesHavePassed() public view returns (bool) {
  return (now >= (lastUpdated + 5 minutes));
}
```

æœ‰äº†è¿™äº›å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºåƒµå°¸è®¾å®šâ€œå†·é™æ—¶é—´â€åŠŸèƒ½ã€‚

## å°†ç»“æ„ä½“ä½œä¸ºå‚æ•°ä¼ å…¥

ç”±äºç»“æ„ä½“çš„å­˜å‚¨æŒ‡é’ˆå¯ä»¥ä»¥å‚æ•°çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªÂ `private`Â æˆ–Â `internal`Â çš„å‡½æ•°ï¼Œå› æ­¤ç»“æ„ä½“å¯ä»¥åœ¨å¤šä¸ªå‡½æ•°ä¹‹é—´ç›¸äº’ä¼ é€’ã€‚

éµå¾ªè¿™æ ·çš„è¯­æ³•ï¼š

```
function _doStuff(Zombie storage _zombie) internal {
  // do stuff with _zombie
}
```

è¿™æ ·æˆ‘ä»¬å¯ä»¥å°†æŸåƒµå°¸çš„å¼•ç”¨ç›´æ¥ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸ç”¨æ˜¯é€šè¿‡å‚æ•°ä¼ å…¥åƒµå°¸IDåï¼Œå‡½æ•°å†ä¾æ®IDå»æŸ¥æ‰¾ã€‚

## ç¬¬7ç« : å…¬æœ‰å‡½æ•°å’Œå®‰å…¨æ€§

ç°åœ¨æ¥ä¿®æ”¹Â `feedAndMultiply`Â ï¼Œå®ç°å†·å´å‘¨æœŸã€‚

å›é¡¾ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œå‰ä¸€è¯¾ä¸Šæˆ‘ä»¬å°†å…¶å¯è§æ€§è®¾ç½®ä¸º`public`ã€‚ä½ å¿…é¡»ä»”ç»†åœ°æ£€æŸ¥æ‰€æœ‰å£°æ˜ä¸ºÂ `public`Â å’ŒÂ `external`çš„å‡½æ•°ï¼Œä¸€ä¸ªä¸ªæ’é™¤ç”¨æˆ·æ»¥ç”¨å®ƒä»¬çš„å¯èƒ½ï¼Œè°¨é˜²å®‰å…¨æ¼æ´ã€‚è¯·è®°ä½ï¼Œå¦‚æœè¿™äº›å‡½æ•°æ²¡æœ‰ç±»ä¼¼Â `onlyOwner`Â è¿™æ ·çš„å‡½æ•°ä¿®é¥°ç¬¦ï¼Œç”¨æˆ·èƒ½åˆ©ç”¨å„ç§å¯èƒ½çš„å‚æ•°å»è°ƒç”¨å®ƒä»¬ã€‚

æ£€æŸ¥å®Œè¿™ä¸ªå‡½æ•°ï¼Œç”¨æˆ·å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸ªå®ƒï¼Œå¹¶ä¼ å…¥ä»–ä»¬æ‰€å¸Œæœ›çš„Â `_targetDna`Â æˆ–Â `species`Â ã€‚æ‰“ä¸ªæ¸¸æˆè¿˜å¾—éµå¾ªè¿™ä¹ˆå¤šçš„è§„åˆ™ï¼Œè¿˜èƒ½ä¸èƒ½æ„‰å¿«åœ°ç©è€å•Šï¼

ä»”ç»†è§‚å¯Ÿï¼Œè¿™ä¸ªå‡½æ•°åªéœ€è¢«Â `feedOnKitty()`Â è°ƒç”¨ï¼Œå› æ­¤ï¼Œæƒ³è¦é˜²æ­¢æ¼æ´ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯è®¾å…¶å¯è§æ€§ä¸ºÂ `internal`ã€‚

### å¸¦å‚æ•°çš„å‡½æ•°ä¿®é¥°ç¬¦

ä¹‹å‰æˆ‘ä»¬å·²ç»è¯»è¿‡ä¸€ä¸ªç®€å•çš„å‡½æ•°ä¿®é¥°ç¬¦äº†ï¼š`onlyOwner`ã€‚å‡½æ•°ä¿®é¥°ç¬¦ä¹Ÿå¯ä»¥å¸¦å‚æ•°ã€‚ä¾‹å¦‚ï¼š

```
// å­˜å‚¨ç”¨æˆ·å¹´é¾„çš„æ˜ å°„
mapping (uint => uint) public age;

// é™å®šç”¨æˆ·å¹´é¾„çš„ä¿®é¥°ç¬¦
modifier olderThan(uint _age, uint _userId) {
  require(age[_userId] >= _age);
  _;
}

// å¿…é¡»å¹´æ»¡16å‘¨å²æ‰å…è®¸å¼€è½¦ (è‡³å°‘åœ¨ç¾å›½æ˜¯è¿™æ ·çš„).
// æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹å‚æ•°è°ƒç”¨`olderThan` ä¿®é¥°ç¬¦:
function driveCar(uint _userId) public olderThan(16, _userId) {
  // å…¶ä½™çš„ç¨‹åºé€»è¾‘
}
```

çœ‹åˆ°äº†å§ï¼ŒÂ `olderThan`Â ä¿®é¥°ç¬¦å¯ä»¥åƒå‡½æ•°ä¸€æ ·æ¥æ”¶å‚æ•°ï¼Œæ˜¯â€œå®¿ä¸»â€å‡½æ•°Â `driveCar`Â æŠŠå‚æ•°ä¼ é€’ç»™å®ƒçš„ä¿®é¥°ç¬¦çš„ã€‚

æ¥ï¼Œæˆ‘ä»¬è‡ªå·±ç”Ÿäº§ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œé€šè¿‡ä¼ å…¥çš„`level`å‚æ•°æ¥é™åˆ¶åƒµå°¸ä½¿ç”¨æŸäº›ç‰¹æ®ŠåŠŸèƒ½ã€‚

### â€œviewâ€ å‡½æ•°ä¸èŠ± â€œgasâ€

å½“ç©å®¶ä»å¤–éƒ¨è°ƒç”¨ä¸€ä¸ª`view`å‡½æ•°ï¼Œæ˜¯ä¸éœ€è¦æ”¯ä»˜ä¸€åˆ† gas çš„ã€‚

è¿™æ˜¯å› ä¸ºÂ `view`Â å‡½æ•°ä¸ä¼šçœŸæ­£æ”¹å˜åŒºå—é“¾ä¸Šçš„ä»»ä½•æ•°æ® - å®ƒä»¬åªæ˜¯è¯»å–ã€‚å› æ­¤ç”¨Â `view`Â æ ‡è®°ä¸€ä¸ªå‡½æ•°ï¼Œæ„å‘³ç€å‘Šè¯‰Â `web3.js`ï¼Œè¿è¡Œè¿™ä¸ªå‡½æ•°åªéœ€è¦æŸ¥è¯¢ä½ çš„æœ¬åœ°ä»¥å¤ªåŠèŠ‚ç‚¹ï¼Œè€Œä¸éœ€è¦åœ¨åŒºå—é“¾ä¸Šåˆ›å»ºä¸€ä¸ªäº‹åŠ¡ï¼ˆäº‹åŠ¡éœ€è¦è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› æ­¤èŠ±è´¹ gasï¼‰ã€‚

ç¨åæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åœ¨è‡ªå·±çš„èŠ‚ç‚¹ä¸Šè®¾ç½® web3.jsã€‚ä½†ç°åœ¨ï¼Œä½ å…³é”®æ˜¯è¦è®°ä½ï¼Œåœ¨æ‰€èƒ½åªè¯»çš„å‡½æ•°ä¸Šæ ‡è®°ä¸Šè¡¨ç¤ºâ€œåªè¯»â€çš„â€œ`external view`Â å£°æ˜ï¼Œå°±èƒ½ä¸ºä½ çš„ç©å®¶å‡å°‘åœ¨ DApp ä¸­ gas ç”¨é‡ã€‚

> æ³¨æ„ï¼šå¦‚æœä¸€ä¸ªÂ `view`Â å‡½æ•°åœ¨å¦ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨è¢«è°ƒç”¨ï¼Œè€Œè°ƒç”¨å‡½æ•°ä¸Â `view`Â å‡½æ•°çš„ä¸å±äºåŒä¸€ä¸ªåˆçº¦ï¼Œä¹Ÿä¼šäº§ç”Ÿè°ƒç”¨æˆæœ¬ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœä¸»è°ƒå‡½æ•°åœ¨ä»¥å¤ªåŠåˆ›å»ºäº†ä¸€ä¸ªäº‹åŠ¡ï¼Œå®ƒä»ç„¶éœ€è¦é€ä¸ªèŠ‚ç‚¹å»éªŒè¯ã€‚æ‰€ä»¥æ ‡è®°ä¸ºÂ `view`Â çš„å‡½æ•°åªæœ‰åœ¨å¤–éƒ¨è°ƒç”¨æ—¶æ‰æ˜¯å…è´¹çš„ã€‚


## ç¬¬11ç« : å­˜å‚¨éå¸¸æ˜‚è´µ

Solidity ä½¿ç”¨`storage`(å­˜å‚¨)æ˜¯ç›¸å½“æ˜‚è´µçš„ï¼Œâ€å†™å…¥â€œæ“ä½œå°¤å…¶è´µã€‚

è¿™æ˜¯å› ä¸ºï¼Œæ— è®ºæ˜¯å†™å…¥è¿˜æ˜¯æ›´æ”¹ä¸€æ®µæ•°æ®ï¼Œ è¿™éƒ½å°†æ°¸ä¹…æ€§åœ°å†™å…¥åŒºå—é“¾ã€‚â€æ°¸ä¹…æ€§â€œå•Šï¼éœ€è¦åœ¨å…¨çƒæ•°åƒä¸ªèŠ‚ç‚¹çš„ç¡¬ç›˜ä¸Šå­˜å…¥è¿™äº›æ•°æ®ï¼Œéšç€åŒºå—é“¾çš„å¢é•¿ï¼Œæ‹·è´ä»½æ•°æ›´å¤šï¼Œå­˜å‚¨é‡ä¹Ÿå°±è¶Šå¤§ã€‚è¿™æ˜¯éœ€è¦æˆæœ¬çš„ï¼

ä¸ºäº†é™ä½æˆæœ¬ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ï¼Œé¿å…å°†æ•°æ®å†™å…¥å­˜å‚¨ã€‚è¿™ä¹Ÿä¼šå¯¼è‡´æ•ˆç‡ä½ä¸‹çš„ç¼–ç¨‹é€»è¾‘ - æ¯”å¦‚æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œéƒ½éœ€è¦åœ¨Â `memory`(å†…å­˜) ä¸­é‡å»ºä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸æ˜¯ç®€å•åœ°å°†ä¸Šæ¬¡è®¡ç®—çš„æ•°ç»„ç»™å­˜å‚¨ä¸‹æ¥ä»¥ä¾¿å¿«é€ŸæŸ¥æ‰¾ã€‚

åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéå†å¤§æ•°æ®é›†åˆéƒ½æ˜¯æ˜‚è´µçš„ã€‚ä½†æ˜¯åœ¨ Solidity ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªæ ‡è®°äº†`external view`çš„å‡½æ•°ï¼Œéå†æ¯”Â `storage`Â è¦ä¾¿å®œå¤ªå¤šï¼Œå› ä¸ºÂ `view`Â å‡½æ•°ä¸ä¼šäº§ç”Ÿä»»ä½•èŠ±é”€ã€‚ ï¼ˆgaså¯æ˜¯çœŸé‡‘ç™½é“¶å•Šï¼ï¼‰ã€‚

æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« è®¨è®º`for`å¾ªç¯ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹çœ‹å¦‚ä½•å¦‚ä½•åœ¨å†…å­˜ä¸­å£°æ˜æ•°ç»„ã€‚

### åœ¨å†…å­˜ä¸­å£°æ˜æ•°ç»„

åœ¨æ•°ç»„åé¢åŠ ä¸ŠÂ `memory`å…³é”®å­—ï¼Œ è¡¨æ˜è¿™ä¸ªæ•°ç»„æ˜¯ä»…ä»…åœ¨å†…å­˜ä¸­åˆ›å»ºï¼Œä¸éœ€è¦å†™å…¥å¤–éƒ¨å­˜å‚¨ï¼Œå¹¶ä¸”åœ¨å‡½æ•°è°ƒç”¨ç»“æŸæ—¶å®ƒå°±è§£æ•£äº†ã€‚ä¸åœ¨ç¨‹åºç»“æŸæ—¶æŠŠæ•°æ®ä¿å­˜è¿›Â `storage`Â çš„åšæ³•ç›¸æ¯”ï¼Œå†…å­˜è¿ç®—å¯ä»¥å¤§å¤§èŠ‚çœgaså¼€é”€ -- æŠŠè¿™æ•°ç»„æ”¾åœ¨`view`é‡Œç”¨ï¼Œå®Œå…¨ä¸ç”¨èŠ±é’±ã€‚

ä»¥ä¸‹æ˜¯ç”³æ˜ä¸€ä¸ªå†…å­˜æ•°ç»„çš„ä¾‹å­ï¼š

```
function getArray() external pure returns(uint[]) {
  // åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º3çš„å†…å­˜æ•°ç»„
  uint[] memory values = new uint[](3);
  // èµ‹å€¼
  values.push(1);
  values.push(2);
  values.push(3);
  // è¿”å›æ•°ç»„
  return values;
}
```

è¿™ä¸ªå°ä¾‹å­å±•ç¤ºäº†ä¸€äº›è¯­æ³•è§„åˆ™ï¼Œä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªå®é™…ç”¨ä¾‹ï¼Œå±•ç¤ºå®ƒå’ŒÂ `for`Â å¾ªç¯ç»“åˆçš„åšæ³•ã€‚

> æ³¨æ„ï¼šå†…å­˜æ•°ç»„Â **å¿…é¡»**Â ç”¨é•¿åº¦å‚æ•°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º`3`ï¼‰åˆ›å»ºã€‚ç›®å‰ä¸æ”¯æŒÂ `array.push()`ä¹‹ç±»çš„æ–¹æ³•è°ƒæ•´æ•°ç»„å¤§å°ï¼Œåœ¨æœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šæ”¯æŒé•¿åº¦ä¿®æ”¹ã€‚

## ç¬¬12ç« : For å¾ªç¯

åœ¨ä¹‹å‰çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡ï¼Œå‡½æ•°ä¸­ä½¿ç”¨çš„æ•°ç»„æ˜¯è¿è¡Œæ—¶åœ¨å†…å­˜ä¸­é€šè¿‡Â `for`Â å¾ªç¯å®æ—¶æ„å»ºï¼Œè€Œä¸æ˜¯é¢„å…ˆå»ºç«‹åœ¨å­˜å‚¨ä¸­çš„ã€‚

ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿ

ä¸ºäº†å®ç°Â `getZombiesByOwner`Â å‡½æ•°ï¼Œä¸€ç§â€œæ— è„‘å¼â€çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨Â `ZombieFactory`Â ä¸­å­˜å…¥â€ä¸»äººâ€œå’Œâ€åƒµå°¸å†›å›¢â€œçš„æ˜ å°„ã€‚

```
mapping (address => uint[]) public ownerToZombies
```

ç„¶åæˆ‘ä»¬æ¯æ¬¡åˆ›å»ºæ–°åƒµå°¸æ—¶ï¼Œæ‰§è¡ŒÂ `ownerToZombies [owner] .pushï¼ˆzombieIdï¼‰`Â å°†å…¶æ·»åŠ åˆ°ä¸»äººçš„åƒµå°¸æ•°ç»„ä¸­ã€‚è€ŒÂ `getZombiesByOwner`Â å‡½æ•°ä¹Ÿéå¸¸ç®€å•ï¼š

```
function getZombiesByOwner(address _owner) external view returns (uint[]) {
  return ownerToZombies[_owner];
}
```

### è¿™ä¸ªåšæ³•æœ‰é—®é¢˜

åšæ³•å€’æ˜¯ç®€å•ã€‚å¯æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥æŠŠä¸€å¤´åƒµå°¸è½¬ç§»åˆ°å¦ä¸€ä¸ªä¸»äººåä¸‹ï¼ˆæˆ‘ä»¬ä¸€å®šä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­å®ç°çš„ï¼‰ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

è¿™ä¸ªâ€œæ¢ä¸»â€å‡½æ•°è¦åšåˆ°ï¼š

1.å°†åƒµå°¸pushåˆ°æ–°ä¸»äººçš„Â `ownerToZombies`Â æ•°ç»„ä¸­ï¼Œ 2.ä»æ—§ä¸»çš„Â `ownerToZombies`Â æ•°ç»„ä¸­ç§»é™¤åƒµå°¸ï¼Œ 3.å°†æ—§ä¸»åƒµå°¸æ•°ç»„ä¸­â€œæ¢ä¸»åƒµå°¸â€ä¹‹åçš„çš„æ¯å¤´åƒµå°¸éƒ½å¾€å‰æŒªä¸€ä½ï¼ŒæŠŠæŒªèµ°â€œæ¢ä¸»åƒµå°¸â€åç•™ä¸‹çš„â€œç©ºæ§½â€å¡«ä¸Šï¼Œ 4.å°†æ•°ç»„é•¿åº¦å‡1ã€‚

ä½†æ˜¯ç¬¬ä¸‰æ­¥å®åœ¨æ˜¯å¤ªè´µäº†ï¼å› ä¸ºæ¯æŒªåŠ¨ä¸€å¤´åƒµå°¸ï¼Œæˆ‘ä»¬éƒ½è¦æ‰§è¡Œä¸€æ¬¡å†™æ“ä½œã€‚å¦‚æœä¸€ä¸ªä¸»äººæœ‰20å¤´åƒµå°¸ï¼Œè€Œç¬¬ä¸€å¤´è¢«æŒªèµ°äº†ï¼Œé‚£ä¸ºäº†ä¿æŒæ•°ç»„çš„é¡ºåºï¼Œæˆ‘ä»¬å¾—åš19ä¸ªå†™æ“ä½œã€‚

ç”±äºå†™å…¥å­˜å‚¨æ˜¯ Solidity ä¸­æœ€è´¹ gas çš„æ“ä½œä¹‹ä¸€ï¼Œä½¿å¾—æ¢ä¸»å‡½æ•°çš„æ¯æ¬¡è°ƒç”¨éƒ½éå¸¸æ˜‚è´µã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæ¯æ¬¡è°ƒç”¨çš„æ—¶å€™èŠ±è´¹çš„ gas éƒ½ä¸åŒï¼å…·ä½“è¿˜å–å†³äºç”¨æˆ·åœ¨åŸä¸»å†›å›¢ä¸­çš„åƒµå°¸å¤´æ•°ï¼Œä»¥åŠç§»èµ°çš„åƒµå°¸æ‰€åœ¨çš„ä½ç½®ã€‚ä»¥è‡³äºç”¨æˆ·éƒ½ä¸çŸ¥é“åº”è¯¥æ”¯ä»˜å¤šå°‘ gasã€‚

> æ³¨æ„ï¼šå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ•°ç»„ä¸­æœ€åä¸€ä¸ªåƒµå°¸å¾€å‰æŒªæ¥å¡«è¡¥ç©ºæ§½ï¼Œå¹¶å°†æ•°ç»„é•¿åº¦å‡å°‘ä¸€ã€‚ä½†è¿™æ ·æ¯åšä¸€ç¬”äº¤æ˜“ï¼Œéƒ½ä¼šæ”¹å˜åƒµå°¸å†›å›¢çš„ç§©åºã€‚

ç”±äºä»å¤–éƒ¨è°ƒç”¨ä¸€ä¸ªÂ `view`Â å‡½æ•°æ˜¯å…è´¹çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨Â `getZombiesByOwner`Â å‡½æ•°ä¸­ç”¨ä¸€ä¸ªforå¾ªç¯éå†æ•´ä¸ªåƒµå°¸æ•°ç»„ï¼ŒæŠŠå±äºæŸä¸ªä¸»äººçš„åƒµå°¸æŒ‘å‡ºæ¥æ„å»ºå‡ºåƒµå°¸æ•°ç»„ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„Â `transfer`Â å‡½æ•°å°†ä¼šä¾¿å®œå¾—å¤šï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦æŒªåŠ¨å­˜å‚¨é‡Œçš„åƒµå°¸æ•°ç»„é‡æ–°æ’åºï¼Œæ€»ä½“ä¸Šè¿™ä¸ªæ–¹æ³•ä¼šæ›´ä¾¿å®œï¼Œè™½ç„¶æœ‰ç‚¹åç›´è§‰ã€‚

### ä½¿ç”¨Â `for`Â å¾ªç¯

`for`å¾ªç¯çš„è¯­æ³•åœ¨ Solidity å’Œ JavaScript ä¸­ç±»ä¼¼ã€‚

æ¥çœ‹ä¸€ä¸ªåˆ›å»ºå¶æ•°æ•°ç»„çš„ä¾‹å­ï¼š

```
function getEvens() pure external returns(uint[]) {
  uint[] memory evens = new uint[](5);
  // åœ¨æ–°æ•°ç»„ä¸­è®°å½•åºåˆ—å·
  uint counter = 0;
  // åœ¨å¾ªç¯ä»1è¿­ä»£åˆ°10ï¼š
  for (uint i = 1; i <= 10; i++) {
    // å¦‚æœ `i` æ˜¯å¶æ•°...
    if (i % 2 == 0) {
      // æŠŠå®ƒåŠ å…¥å¶æ•°æ•°ç»„
      evens[counter] = i;
      //ç´¢å¼•åŠ ä¸€ï¼Œ æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºçš„â€˜evenâ€™
      counter++;
    }
  }
  return evens;
}
```

è¿™ä¸ªå‡½æ•°å°†è¿”å›ä¸€ä¸ªå½¢ä¸ºÂ `[2,4,6,8,10]`Â çš„æ•°ç»„ã€‚


## ç¬¬1ç« : å¯æ”¯ä»˜

æˆªè‡³ç›®å‰ï¼Œæˆ‘ä»¬åªæ¥è§¦åˆ°å¾ˆå°‘çš„Â **_å‡½æ•°ä¿®é¥°ç¬¦_**ã€‚ è¦è®°ä½æ‰€æœ‰çš„ä¸œè¥¿å¾ˆéš¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸ªæ¦‚è§ˆï¼š

1.  æˆ‘ä»¬æœ‰å†³å®šå‡½æ•°ä½•æ—¶å’Œè¢«è°è°ƒç”¨çš„å¯è§æ€§ä¿®é¥°ç¬¦:Â `private`Â æ„å‘³ç€å®ƒåªèƒ½è¢«åˆçº¦å†…éƒ¨è°ƒç”¨ï¼›Â `internal`Â å°±åƒÂ `private`Â ä½†æ˜¯ä¹Ÿèƒ½è¢«ç»§æ‰¿çš„åˆçº¦è°ƒç”¨ï¼›Â `external`Â åªèƒ½ä»åˆçº¦å¤–éƒ¨è°ƒç”¨ï¼›æœ€åÂ `public`Â å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ï¼Œä¸ç®¡æ˜¯å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚
    
2.  æˆ‘ä»¬ä¹Ÿæœ‰çŠ¶æ€ä¿®é¥°ç¬¦ï¼Œ å‘Šè¯‰æˆ‘ä»¬å‡½æ•°å¦‚ä½•å’ŒåŒºå—é“¾äº¤äº’:Â `view`Â å‘Šè¯‰æˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‡½æ•°ä¸ä¼šæ›´æ”¹å’Œä¿å­˜ä»»ä½•æ•°æ®ï¼›Â `pure`Â å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå‡½æ•°ä¸ä½†ä¸ä¼šå¾€åŒºå—é“¾å†™æ•°æ®ï¼Œå®ƒç”šè‡³ä¸ä»åŒºå—é“¾è¯»å–æ•°æ®ã€‚è¿™ä¸¤ç§åœ¨è¢«ä»åˆçº¦å¤–éƒ¨è°ƒç”¨çš„æ—¶å€™éƒ½ä¸èŠ±è´¹ä»»ä½•gasï¼ˆä½†æ˜¯å®ƒä»¬åœ¨è¢«å†…éƒ¨å…¶ä»–å‡½æ•°è°ƒç”¨çš„æ—¶å€™å°†ä¼šè€—è´¹gasï¼‰ã€‚
    
3.  ç„¶åæˆ‘ä»¬æœ‰äº†è‡ªå®šä¹‰çš„Â `modifiers`ï¼Œä¾‹å¦‚åœ¨ç¬¬ä¸‰è¯¾å­¦ä¹ çš„:Â `onlyOwner`Â å’ŒÂ `aboveLevel`ã€‚ å¯¹äºè¿™äº›ä¿®é¥°ç¬¦æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å…¶å¯¹å‡½æ•°çš„çº¦æŸé€»è¾‘ã€‚
    

è¿™äº›ä¿®é¥°ç¬¦å¯ä»¥åŒæ—¶ä½œç”¨äºä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸Šï¼š

```
function test() external view onlyOwner anotherModifier { /* ... */ }
```

åœ¨è¿™ä¸€ç« ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸ªæ–°çš„ä¿®é¥°ç¬¦Â `payable`.

### `payable`Â ä¿®é¥°ç¬¦

`payable`Â æ–¹æ³•æ˜¯è®© Solidity å’Œä»¥å¤ªåŠå˜å¾—å¦‚æ­¤é…·çš„ä¸€éƒ¨åˆ† â€”â€” å®ƒä»¬æ˜¯ä¸€ç§å¯ä»¥æ¥æ”¶ä»¥å¤ªçš„ç‰¹æ®Šå‡½æ•°ã€‚

å…ˆæ”¾ä¸€ä¸‹ã€‚å½“ä½ åœ¨è°ƒç”¨ä¸€ä¸ªæ™®é€šç½‘ç«™æœåŠ¡å™¨ä¸Šçš„APIå‡½æ•°çš„æ—¶å€™ï¼Œä½ æ— æ³•ç”¨ä½ çš„å‡½æ•°ä¼ é€ç¾å…ƒâ€”â€”ä½ ä¹Ÿä¸èƒ½ä¼ é€æ¯”ç‰¹å¸ã€‚

ä½†æ˜¯åœ¨ä»¥å¤ªåŠä¸­ï¼Œ å› ä¸ºé’± (_ä»¥å¤ª_), æ•°æ® (_äº‹åŠ¡è´Ÿè½½_)ï¼Œ ä»¥åŠåˆçº¦ä»£ç æœ¬èº«éƒ½å­˜åœ¨äºä»¥å¤ªåŠã€‚ä½ å¯ä»¥åœ¨åŒæ—¶è°ƒç”¨å‡½æ•°Â **å¹¶**ä»˜é’±ç»™å¦å¤–ä¸€ä¸ªåˆçº¦ã€‚

è¿™å°±å…è®¸å‡ºç°å¾ˆå¤šæœ‰è¶£çš„é€»è¾‘ï¼Œ æ¯”å¦‚å‘ä¸€ä¸ªåˆçº¦è¦æ±‚æ”¯ä»˜ä¸€å®šçš„é’±æ¥è¿è¡Œä¸€ä¸ªå‡½æ•°ã€‚

### ä¾‹å­

```
contract OnlineStore {
  function buySomething() external payable {
    // æ£€æŸ¥ä»¥ç¡®å®š0.001ä»¥å¤ªå‘é€å‡ºå»æ¥è¿è¡Œå‡½æ•°:
    require(msg.value == 0.001 ether);
    // å¦‚æœä¸ºçœŸï¼Œä¸€äº›ç”¨æ¥å‘å‡½æ•°è°ƒç”¨è€…å‘é€æ•°å­—å†…å®¹çš„é€»è¾‘
    transferThing(msg.sender);
  }
}
```

åœ¨è¿™é‡Œï¼Œ`msg.value`Â æ˜¯ä¸€ç§å¯ä»¥æŸ¥çœ‹å‘åˆçº¦å‘é€äº†å¤šå°‘ä»¥å¤ªçš„æ–¹æ³•ï¼Œå¦å¤–Â `ether`Â æ˜¯ä¸€ä¸ªå…§å»ºå•å…ƒã€‚

è¿™é‡Œå‘ç”Ÿçš„äº‹æ˜¯ï¼Œä¸€äº›äººä¼šä» web3.js è°ƒç”¨è¿™ä¸ªå‡½æ•° (ä»DAppçš„å‰ç«¯)ï¼Œ åƒè¿™æ · :

```
// å‡è®¾ `OnlineStore` åœ¨ä»¥å¤ªåŠä¸ŠæŒ‡å‘ä½ çš„åˆçº¦:
OnlineStore.buySomething().send(from: web3.eth.defaultAccount, value: web3.utils.toWei(0.001))
```

æ³¨æ„è¿™ä¸ªÂ `value`Â å­—æ®µï¼Œ JavaScript è°ƒç”¨æ¥æŒ‡å®šå‘é€å¤šå°‘(0.001)`ä»¥å¤ª`ã€‚å¦‚æœæŠŠäº‹åŠ¡æƒ³è±¡æˆä¸€ä¸ªä¿¡å°ï¼Œä½ å‘é€åˆ°å‡½æ•°çš„å‚æ•°å°±æ˜¯ä¿¡çš„å†…å®¹ã€‚ æ·»åŠ ä¸€ä¸ªÂ `value`Â å¾ˆåƒåœ¨ä¿¡å°é‡Œé¢æ”¾é’± â€”â€” ä¿¡ä»¶å†…å®¹å’Œé’±åŒæ—¶å‘é€ç»™äº†æ¥æ”¶è€…ã€‚

> æ³¨æ„ï¼š å¦‚æœä¸€ä¸ªå‡½æ•°æ²¡æ ‡è®°ä¸º`payable`ï¼Œ è€Œä½ å°è¯•åˆ©ç”¨ä¸Šé¢çš„æ–¹æ³•å‘é€ä»¥å¤ªï¼Œå‡½æ•°å°†æ‹’ç»ä½ çš„äº‹åŠ¡ã€‚


## ç¬¬2ç« : æç°

åœ¨ä¸Šä¸€ç« ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å‘åˆçº¦å‘é€ä»¥å¤ªï¼Œé‚£ä¹ˆåœ¨å‘é€ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

åœ¨ä½ å‘é€ä»¥å¤ªä¹‹åï¼Œå®ƒå°†è¢«å­˜å‚¨è¿›ä»¥åˆçº¦çš„ä»¥å¤ªåŠè´¦æˆ·ä¸­ï¼Œ å¹¶å†»ç»“åœ¨å“ªé‡Œ â€”â€” é™¤éä½ æ·»åŠ ä¸€ä¸ªå‡½æ•°æ¥ä»åˆçº¦ä¸­æŠŠä»¥å¤ªæç°ã€‚

ä½ å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°æ¥ä»åˆçº¦ä¸­æç°ä»¥å¤ªï¼Œç±»ä¼¼è¿™æ ·ï¼š

```
contract GetPaid is Ownable {
  function withdraw() external onlyOwner {
    owner.transfer(this.balance);
  }
}
```

æ³¨æ„æˆ‘ä»¬ä½¿ç”¨Â `Ownable`Â åˆçº¦ä¸­çš„Â `owner`Â å’ŒÂ `onlyOwner`ï¼Œå‡å®šå®ƒå·²ç»è¢«å¼•å…¥äº†ã€‚

ä½ å¯ä»¥é€šè¿‡Â `transfer`Â å‡½æ•°å‘ä¸€ä¸ªåœ°å€å‘é€ä»¥å¤ªï¼Œ ç„¶åÂ `this.balance`Â å°†è¿”å›å½“å‰åˆçº¦å­˜å‚¨äº†å¤šå°‘ä»¥å¤ªã€‚ æ‰€ä»¥å¦‚æœ100ä¸ªç”¨æˆ·æ¯äººå‘æˆ‘ä»¬æ”¯ä»˜1ä»¥å¤ªï¼ŒÂ `this.balance`Â å°†æ˜¯100ä»¥å¤ªã€‚

ä½ å¯ä»¥é€šè¿‡Â `transfer`Â å‘ä»»ä½•ä»¥å¤ªåŠåœ°å€ä»˜é’±ã€‚ æ¯”å¦‚ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªå‡½æ•°åœ¨Â `msg.sender`Â è¶…é¢ä»˜æ¬¾çš„æ—¶å€™ç»™ä»–ä»¬é€€é’±ï¼š

```
uint itemFee = 0.001 ether;
msg.sender.transfer(msg.value - itemFee);
```

æˆ–è€…åœ¨ä¸€ä¸ªæœ‰å–å®¶å’Œå–å®¶çš„åˆçº¦ä¸­ï¼Œ ä½ å¯ä»¥æŠŠå–å®¶çš„åœ°å€å­˜å‚¨èµ·æ¥ï¼Œ å½“æœ‰äººä¹°äº†å®ƒçš„ä¸œè¥¿çš„æ—¶å€™ï¼ŒæŠŠä¹°å®¶æ”¯ä»˜çš„é’±å‘é€ç»™å®ƒÂ `seller.transfer(msg.value)`ã€‚

æœ‰å¾ˆå¤šä¾‹å­æ¥å±•ç¤ºä»€ä¹ˆè®©ä»¥å¤ªåŠç¼–ç¨‹å¦‚æ­¤ä¹‹é…· â€”â€” ä½ å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªä¸è¢«ä»»ä½•äººæ§åˆ¶çš„å»ä¸­å¿ƒåŒ–å¸‚åœºã€‚


## ç”¨Â `keccak256`Â æ¥åˆ¶é€ éšæœºæ•°ã€‚

Solidity ä¸­æœ€å¥½çš„éšæœºæ•°ç”Ÿæˆå™¨æ˜¯Â `keccak256`Â å“ˆå¸Œå‡½æ•°.

æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥ç”Ÿæˆä¸€äº›éšæœºæ•°

```
// ç”Ÿæˆä¸€ä¸ª0åˆ°100çš„éšæœºæ•°:
uint randNonce = 0;
uint random = uint(keccak256(now, msg.sender, randNonce)) % 100;
randNonce++;
uint random2 = uint(keccak256(now, msg.sender, randNonce)) % 100;
```

è¿™ä¸ªæ–¹æ³•é¦–å…ˆæ‹¿åˆ°Â `now`Â çš„æ—¶é—´æˆ³ã€Â `msg.sender`ã€ ä»¥åŠä¸€ä¸ªè‡ªå¢æ•°Â `nonce`Â ï¼ˆä¸€ä¸ªä»…ä¼šè¢«ä½¿ç”¨ä¸€æ¬¡çš„æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šå¯¹ç›¸åŒçš„è¾“å…¥å€¼è°ƒç”¨ä¸€æ¬¡ä»¥ä¸Šå“ˆå¸Œå‡½æ•°äº†ï¼‰ã€‚

ç„¶ååˆ©ç”¨Â `keccak`Â æŠŠè¾“å…¥çš„å€¼è½¬å˜ä¸ºä¸€ä¸ªå“ˆå¸Œå€¼, å†å°†å“ˆå¸Œå€¼è½¬æ¢ä¸ºÂ `uint`, ç„¶ååˆ©ç”¨Â `% 100`Â æ¥å–æœ€åä¸¤ä½, å°±ç”Ÿæˆäº†ä¸€ä¸ª0åˆ°100ä¹‹é—´éšæœºæ•°äº†ã€‚

### è¿™ä¸ªæ–¹æ³•å¾ˆå®¹æ˜“è¢«ä¸è¯šå®çš„èŠ‚ç‚¹æ”»å‡»

åœ¨ä»¥å¤ªåŠä¸Š, å½“ä½ åœ¨å’Œä¸€ä¸ªåˆçº¦ä¸Šè°ƒç”¨å‡½æ•°çš„æ—¶å€™, ä½ ä¼šæŠŠå®ƒå¹¿æ’­ç»™ä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…åœ¨ç½‘ç»œä¸Šçš„Â **_transaction_**Â èŠ‚ç‚¹ä»¬ã€‚ ç½‘ç»œä¸Šçš„èŠ‚ç‚¹å°†æ”¶é›†å¾ˆå¤šäº‹åŠ¡, è¯•ç€æˆä¸ºç¬¬ä¸€ä¸ªè§£å†³è®¡ç®—å¯†é›†å‹æ•°å­¦é—®é¢˜çš„äººï¼Œä½œä¸ºâ€œå·¥ä½œè¯æ˜â€ï¼Œç„¶åå°†â€œå·¥ä½œè¯æ˜â€(Proof of Work, PoW)å’Œäº‹åŠ¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªÂ **_block_**Â å‘å¸ƒåœ¨ç½‘ç»œä¸Šã€‚

ä¸€æ—¦ä¸€ä¸ªèŠ‚ç‚¹è§£å†³äº†ä¸€ä¸ªPoW, å…¶ä»–èŠ‚ç‚¹å°±ä¼šåœæ­¢å°è¯•è§£å†³è¿™ä¸ª PoW, å¹¶éªŒè¯å…¶ä»–èŠ‚ç‚¹çš„äº‹åŠ¡åˆ—è¡¨æ˜¯æœ‰æ•ˆçš„ï¼Œç„¶åæ¥å—è¿™ä¸ªèŠ‚ç‚¹è½¬è€Œå°è¯•è§£å†³ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚

**è¿™å°±è®©æˆ‘ä»¬çš„éšæœºæ•°å‡½æ•°å˜å¾—å¯åˆ©ç”¨äº†**

æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¡¬å¸ç¿»è½¬åˆçº¦â€”â€”æ­£é¢ä½ èµ¢åŒå€é’±ï¼Œåé¢ä½ è¾“æ‰æ‰€æœ‰çš„é’±ã€‚å‡å¦‚å®ƒä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥å†³å®šæ˜¯æ­£é¢è¿˜æ˜¯åé¢ (`random >= 50`Â ç®—æ­£é¢,Â `random < 50`Â ç®—åé¢)ã€‚

å¦‚æœæˆ‘æ­£è¿è¡Œä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘å¯ä»¥Â **åªå¯¹æˆ‘è‡ªå·±çš„èŠ‚ç‚¹**Â å‘å¸ƒä¸€ä¸ªäº‹åŠ¡ï¼Œä¸”ä¸åˆ†äº«å®ƒã€‚ æˆ‘å¯ä»¥è¿è¡Œç¡¬å¸ç¿»è½¬æ–¹æ³•æ¥å·çª¥æˆ‘çš„è¾“èµ¢ â€” å¦‚æœæˆ‘è¾“äº†ï¼Œæˆ‘å°±ä¸æŠŠè¿™ä¸ªäº‹åŠ¡åŒ…å«è¿›æˆ‘è¦è§£å†³çš„ä¸‹ä¸€ä¸ªåŒºå—ä¸­å»ã€‚æˆ‘å¯ä»¥ä¸€ç›´è¿è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œç›´åˆ°æˆ‘èµ¢å¾—äº†ç¡¬å¸ç¿»è½¬å¹¶è§£å†³äº†ä¸‹ä¸€ä¸ªåŒºå—ï¼Œç„¶åè·åˆ©ã€‚

### å¦‚ä½•åœ¨ä»¥å¤ªåŠä¸Šå®‰å…¨åœ°ç”Ÿæˆéšæœºæ•°

å› ä¸ºåŒºå—é“¾çš„å…¨éƒ¨å†…å®¹å¯¹æ‰€æœ‰å‚ä¸è€…æ¥è¯´æ˜¯é€æ˜çš„ï¼Œ è¿™å°±è®©è¿™ä¸ªé—®é¢˜å˜å¾—å¾ˆéš¾ï¼Œå®ƒçš„è§£å†³æ–¹æ³•ä¸åœ¨æœ¬è¯¾ç¨‹è®¨è®ºèŒƒå›´ï¼Œä½ å¯ä»¥é˜…è¯»Â [è¿™ä¸ª StackOverflow ä¸Šçš„è®¨è®º](https://ethereum.stackexchange.com/questions/191/how-can-i-securely-generate-a-random-number-in-my-smart-contract)Â æ¥è·å¾—ä¸€äº›ä¸»æ„ã€‚ ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ©ç”¨Â **_oracle_**Â æ¥è®¿é—®ä»¥å¤ªåŠåŒºå—é“¾ä¹‹å¤–çš„éšæœºæ•°å‡½æ•°ã€‚

å½“ç„¶ï¼Œ å› ä¸ºç½‘ç»œä¸Šæˆåƒä¸Šä¸‡çš„ä»¥å¤ªåŠèŠ‚ç‚¹éƒ½åœ¨ç«äº‰è§£å†³ä¸‹ä¸€ä¸ªåŒºå—ï¼Œæˆ‘èƒ½æˆåŠŸè§£å†³ä¸‹ä¸€ä¸ªåŒºå—çš„å‡ ç‡éå¸¸ä¹‹ä½ã€‚ è¿™å°†èŠ±è´¹æˆ‘ä»¬å·¨å¤§çš„è®¡ç®—èµ„æºæ¥å¼€å‘è¿™ä¸ªè·åˆ©æ–¹æ³• â€” ä½†æ˜¯å¦‚æœå¥–åŠ±å¼‚å¸¸åœ°é«˜(æ¯”å¦‚æˆ‘å¯ä»¥åœ¨ç¡¬å¸ç¿»è½¬å‡½æ•°ä¸­èµ¢å¾— 1ä¸ªäº¿)ï¼Œ é‚£å°±å¾ˆå€¼å¾—å»æ”»å‡»äº†ã€‚

æ‰€ä»¥å°½ç®¡è¿™ä¸ªæ–¹æ³•åœ¨ä»¥å¤ªåŠä¸Šä¸å®‰å…¨ï¼Œåœ¨å®é™…ä¸­ï¼Œé™¤éæˆ‘ä»¬çš„éšæœºå‡½æ•°æœ‰ä¸€å¤§ç¬”é’±åœ¨ä¸Šé¢ï¼Œä½ æ¸¸æˆçš„ç”¨æˆ·ä¸€èˆ¬æ˜¯æ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå»æ”»å‡»çš„ã€‚

å› ä¸ºåœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨ç¼–å†™ä¸€ä¸ªç®€å•çš„æ¸¸æˆæ¥åšæ¼”ç¤ºï¼Œä¹Ÿæ²¡æœ‰çœŸæ­£çš„é’±åœ¨é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šæ¥å—è¿™ä¸ªä¸è¶³ä¹‹å¤„ï¼Œä½¿ç”¨è¿™ä¸ªç®€å•çš„éšæœºæ•°ç”Ÿæˆå‡½æ•°ã€‚ä½†æ˜¯è¦è°¨è®°å®ƒæ˜¯ä¸å®‰å…¨çš„ã€‚


# ç¬¬1ç« : ä»¥å¤ªåŠä¸Šçš„ä»£å¸

è®©æˆ‘ä»¬æ¥èŠèŠÂ **ä»£å¸**

å¦‚æœä½ å¯¹ä»¥å¤ªåŠçš„ä¸–ç•Œæœ‰ä¸€äº›äº†è§£ï¼Œä½ å¾ˆå¯èƒ½å¬è¿‡äººä»¬èŠåˆ°ä»£å¸â€”â€”å°¤å…¶æ˜¯Â **_ERC20 ä»£å¸_**.

ä¸€ä¸ªÂ **ä»£å¸**Â åœ¨ä»¥å¤ªåŠåŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªéµå¾ªä¸€äº›å…±åŒè§„åˆ™çš„æ™ºèƒ½åˆçº¦â€”â€”å³å®ƒå®ç°äº†æ‰€æœ‰å…¶ä»–ä»£å¸åˆçº¦å…±äº«çš„ä¸€ç»„æ ‡å‡†å‡½æ•°ï¼Œä¾‹å¦‚Â `transfer(address _to, uint256 _value)`Â å’ŒÂ `balanceOf(address _owner)`.

åœ¨æ™ºèƒ½åˆçº¦å†…éƒ¨ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªæ˜ å°„ï¼ŒÂ `mapping(address => uint256) balances`ï¼Œç”¨äºè¿½è¸ªæ¯ä¸ªåœ°å€è¿˜æœ‰å¤šå°‘ä½™é¢ã€‚

æ‰€ä»¥åŸºæœ¬ä¸Šä¸€ä¸ªä»£å¸åªæ˜¯ä¸€ä¸ªè¿½è¸ªè°æ‹¥æœ‰å¤šå°‘è¯¥ä»£å¸çš„åˆçº¦ï¼Œå’Œä¸€äº›å¯ä»¥è®©é‚£äº›ç”¨æˆ·å°†ä»–ä»¬çš„ä»£å¸è½¬ç§»åˆ°å…¶ä»–åœ°å€çš„å‡½æ•°ã€‚

### å®ƒä¸ºä»€ä¹ˆé‡è¦å‘¢ï¼Ÿ

ç”±äºæ‰€æœ‰ ERC20 ä»£å¸å…±äº«å…·æœ‰ç›¸åŒåç§°çš„åŒä¸€ç»„å‡½æ•°ï¼Œå®ƒä»¬éƒ½å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œäº¤äº’ã€‚

è¿™æ„å‘³ç€å¦‚æœä½ æ„å»ºçš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿä¸ä¸€ä¸ª ERC20 ä»£å¸è¿›è¡Œäº¤äº’ï¼Œé‚£ä¹ˆå®ƒå°±ä¹Ÿèƒ½å¤Ÿä¸ä»»ä½• ERC20 ä»£å¸è¿›è¡Œäº¤äº’ã€‚ è¿™æ ·ä¸€æ¥ï¼Œå°†æ¥ä½ å°±å¯ä»¥è½»æ¾åœ°å°†æ›´å¤šçš„ä»£å¸æ·»åŠ åˆ°ä½ çš„åº”ç”¨ä¸­ï¼Œè€Œæ— éœ€è¿›è¡Œè‡ªå®šä¹‰ç¼–ç ã€‚ ä½ å¯ä»¥ç®€å•åœ°æ’å…¥æ–°çš„ä»£å¸åˆçº¦åœ°å€ï¼Œç„¶åå“—å•¦ï¼Œä½ çš„åº”ç”¨ç¨‹åºæœ‰å¦ä¸€ä¸ªå®ƒå¯ä»¥ä½¿ç”¨çš„ä»£å¸äº†ã€‚

å…¶ä¸­ä¸€ä¸ªä¾‹å­å°±æ˜¯äº¤æ˜“æ‰€ã€‚ å½“äº¤æ˜“æ‰€æ·»åŠ ä¸€ä¸ªæ–°çš„ ERC20 ä»£å¸æ—¶ï¼Œå®é™…ä¸Šå®ƒåªéœ€è¦æ·»åŠ ä¸ä¹‹å¯¹è¯çš„å¦ä¸€ä¸ªæ™ºèƒ½åˆçº¦ã€‚ ç”¨æˆ·å¯ä»¥è®©é‚£ä¸ªåˆçº¦å°†ä»£å¸å‘é€åˆ°äº¤æ˜“æ‰€çš„é’±åŒ…åœ°å€ï¼Œç„¶åäº¤æ˜“æ‰€å¯ä»¥è®©åˆçº¦åœ¨ç”¨æˆ·è¦æ±‚å–æ¬¾æ—¶å°†ä»£å¸å‘é€å›ç»™ä»–ä»¬ã€‚

äº¤æ˜“æ‰€åªéœ€è¦å®ç°è¿™ç§è½¬ç§»é€»è¾‘ä¸€æ¬¡ï¼Œç„¶åå½“å®ƒæƒ³è¦æ·»åŠ ä¸€ä¸ªæ–°çš„ ERC20 ä»£å¸æ—¶ï¼Œåªéœ€å°†æ–°çš„åˆçº¦åœ°å€æ·»åŠ åˆ°å®ƒçš„æ•°æ®åº“å³å¯ã€‚

### å…¶ä»–ä»£å¸æ ‡å‡†

å¯¹äºåƒè´§å¸ä¸€æ ·çš„ä»£å¸æ¥è¯´ï¼ŒERC20 ä»£å¸éå¸¸é…·ã€‚ ä½†æ˜¯è¦åœ¨æˆ‘ä»¬åƒµå°¸æ¸¸æˆä¸­ä»£è¡¨åƒµå°¸å°±å¹¶ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ã€‚

é¦–å…ˆï¼Œåƒµå°¸ä¸åƒè´§å¸å¯ä»¥åˆ†å‰² â€”â€” æˆ‘å¯ä»¥å‘ç»™ä½  0.237 ä»¥å¤ªï¼Œä½†æ˜¯è½¬ç§»ç»™ä½  0.237 çš„åƒµå°¸å¬èµ·æ¥å°±æœ‰äº›æç¬‘ã€‚

å…¶æ¬¡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰åƒµå°¸éƒ½æ˜¯å¹³ç­‰çš„ã€‚ ä½ çš„2çº§åƒµå°¸"**Steve**"å®Œå…¨ä¸èƒ½ç­‰åŒäºæˆ‘732çº§çš„åƒµå°¸"**H4XF13LD MORRIS ğŸ’¯ğŸ’¯ğŸ˜ğŸ’¯ğŸ’¯**"ã€‚ï¼ˆä½ å·®å¾—è¿œå‘¢ï¼Œ_Steve_ï¼‰ã€‚

æœ‰å¦ä¸€ä¸ªä»£å¸æ ‡å‡†æ›´é€‚åˆå¦‚ CryptoZombies è¿™æ ·çš„åŠ å¯†æ”¶è—å“â€”â€”å®ƒä»¬è¢«ç§°ä¸º**_ERC721 ä»£å¸._**

**ERC721 ä»£å¸**æ˜¯**ä¸èƒ½äº’æ¢**çš„ï¼Œå› ä¸ºæ¯ä¸ªä»£å¸éƒ½è¢«è®¤ä¸ºæ˜¯å”¯ä¸€ä¸”ä¸å¯åˆ†å‰²çš„ã€‚ ä½ åªèƒ½ä»¥æ•´ä¸ªå•ä½äº¤æ˜“å®ƒä»¬ï¼Œå¹¶ä¸”æ¯ä¸ªå•ä½éƒ½æœ‰å”¯ä¸€çš„ IDã€‚

> è¯·æ³¨æ„ï¼Œä½¿ç”¨åƒ ERC721 è¿™æ ·çš„æ ‡å‡†çš„ä¼˜åŠ¿å°±æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…åœ¨æˆ‘ä»¬çš„åˆçº¦ä¸­å®ç°æ‹å–æˆ–æ‰˜ç®¡é€»è¾‘ï¼Œè¿™å†³å®šäº†ç©å®¶èƒ½å¤Ÿå¦‚ä½•äº¤æ˜“ï¼å‡ºå”®æˆ‘ä»¬çš„åƒµå°¸ã€‚ å¦‚æœæˆ‘ä»¬ç¬¦åˆè§„èŒƒï¼Œå…¶ä»–äººå¯ä»¥ä¸ºåŠ å¯†å¯äº¤æ˜“çš„ ERC721 èµ„äº§æ­å»ºä¸€ä¸ªäº¤æ˜“æ‰€å¹³å°ï¼Œæˆ‘ä»¬çš„ ERC721 åƒµå°¸å°†å¯ä»¥åœ¨è¯¥å¹³å°ä¸Šä½¿ç”¨ã€‚ æ‰€ä»¥ä½¿ç”¨ä»£å¸æ ‡å‡†ç›¸è¾ƒäºä½¿ç”¨ä½ è‡ªå·±çš„äº¤æ˜“é€»è¾‘æœ‰æ˜æ˜¾çš„å¥½å¤„ã€‚
